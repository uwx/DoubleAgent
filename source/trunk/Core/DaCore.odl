import "oaidl.idl";
import "ocidl.idl";
import "wtypes.idl";
import "objidl.idl";

[uuid(1147E560-A208-11DE-ABF2-002421116FB2), object]
interface IDaPreview : IUnknown
{
	[] HRESULT PlayAnimation ([in] BSTR pAnimationName);
	[] HRESULT PlayState ([in] BSTR pStateName);
	[] HRESULT GetIsPlaying ([out] boolean * pIsPlaying);
	[] HRESULT StopPlaying ();
	[] HRESULT GetSoundsEnabled ([out] boolean * pEnabled);
	[] HRESULT EnableSounds ([in] boolean pEnabled);
	[] HRESULT GetIdleEnabled ([out] boolean * pEnabled);
	[] HRESULT EnableIdle ([in] boolean pEnabled);
	[] HRESULT SetBkColor ([in] COLORREF pBkColor);
	[] HRESULT GetFrameSize ([out] SIZE* pFrameSize);
	[] HRESULT GetCharacterFrameSize ([in] BSTR pCharacterPath, [out] SIZE* pFrameSize);
	[] HRESULT GetFrameFormat ([out] BYTE** pFrameFormat);
	[] HRESULT GetCharacterFrameFormat ([in] BSTR pCharacterPath, [out] BYTE** pFrameFormat);
	[] HRESULT OnAppActive ([in] boolean pActive);
	[] HRESULT RenderFrame ([in] HDC pDC, [in] POINT* pPosition);
	[] HRESULT RenderAnimationFrame ([in] BSTR pAnimationName, [in] USHORT pFrameNum, [in] HDC pDC, [in] POINT* pPosition);
	[] HRESULT RenderCharacterFrame ([in] BSTR pCharacterPath, [in] BSTR pAnimationName, [in] USHORT pFrameNum, [in] HDC pDC, [in] POINT* pPosition);
	[] HRESULT OpenFile ([in] BSTR pCharacterPath, [in] HWND pParentWnd);
	[] HRESULT GetCharacterPath ([out] BSTR * pCharacterPath);
	[] HRESULT GetCharacterName ([out] BSTR * pCharacterName, [in,defaultvalue(0)] USHORT pLangID);
	[] HRESULT GetCharacterDescription ([out] BSTR * pCharacterDescription, [in,defaultvalue(0)] USHORT pLangID);
	[] HRESULT GetCharacterGuid ([out] GUID* pGuid);
};

/////////////////////////////////////////////////////////////////////////////

[
	uuid(1147E561-A208-11DE-ABF2-002421116FB2),
	helpstring("DoubleAgent Preview")
]
coclass DaPreview
{
	[default] interface IDaPreview;
};

/////////////////////////////////////////////////////////////////////////////

[uuid(1147E562-A208-11DE-ABF2-002421116FB2), object, hidden]
interface _IAgentStreamInfo : IUnknown
{
	[] HRESULT GetMaxSequenceDuration ([out] long* pMaxSequenceDuration) const;
	[] HRESULT GetMaxSequenceFrames ([out] long* pMaxSequenceFrames) const;

	[] HRESULT GetAnimationIndex ([out] long* pAnimationNdx) const;
	[] HRESULT SetAnimationIndex ([in] long pAnimationNdx);
	[] HRESULT GetAnimationName ([out] BSTR * pAnimationName) const;
	[] HRESULT SetAnimationName ([in] BSTR pAnimationName);
	[] HRESULT GetAnimationSource ([out] BSTR * pAnimationSource) const;
	[] HRESULT SetAnimationSource ([in] BSTR pAnimationSource);

	[] HRESULT CalcAnimationFrameCount ([out] long* pAnimationFrameCount, [in] long pAnimationNdx) const;
	[] HRESULT CalcAnimationDuration ([out] long* pAnimationDuration, [in] long pAnimationNdx) const;
	[] HRESULT FindAnimationSpeakingFrame ([out] long* pSpeakingFrameNdx, [in] long pAnimationNdx, [in,defaultvalue(0)] long pStartFrameNdx) const;

	[] HRESULT NewAnimationSequence ();
	[] HRESULT EndAnimationSequence ();
	[] HRESULT ClearAnimationSequences ();

	[] HRESULT GetSequenceFrameCount ([out] long* pSequenceFrameCount) const;
	[] HRESULT GetSequenceDuration ([out] long* pSequenceDuration) const;
	[] HRESULT GetSequenceLoop ([out] long* pLoopDuration) const;
	[] HRESULT CalcSequenceTimeNdx ([out] long* pTimeNdx, [in] long pFrameNum, [in,defaultvalue(FALSE)] boolean pClampFrameNum) const;
	[] HRESULT CalcSequenceFrameNum ([out] long* pFrameNum, [in] long pTimeNdx, [in,defaultvalue(FALSE)] boolean pClampTimeNdx) const;
	[] HRESULT CalcSequenceAnimationFrameNdx ([out] long* pAnimationNdx, [out] long* pFrameNdx, [in] long pTimeNdx, [in,defaultvalue(FALSE)] boolean pClampTimeNdx) const;

	[] HRESULT SequenceAll ();
	[] HRESULT SequenceAnimation ([in] long pAnimationNdx, [in,defaultvalue(0)] long pMaxLoopTime);
	[] HRESULT SequenceAnimationLoop ([in] long pAnimationNdx, [in,defaultvalue(0)] long pMaxLoopTime);
	[] HRESULT SequenceAnimationExit ([in] long pAnimationNdx, [in] long pLastFrameNdx);

	[] HRESULT CueSequenceAudio ([in,defaultvalue(0)] long pStartFrameNum);
	[] HRESULT ClearSequenceAudio ();
};

/////////////////////////////////////////////////////////////////////////////

[uuid(1147E567-A208-11DE-ABF2-002421116FB2), object, hidden]
interface _IAgentStreamSource : IUnknown
{
	[] HRESULT GetAgentFile ([out] ULONG_PTR * pAgentFile);
	[] HRESULT SetAgentFile ([in] ULONG_PTR pAgentFile);
	[] HRESULT GetAgentStreamInfo ([out] ULONG_PTR * pAgentStreamInfo);
	[] HRESULT SetAgentStreamInfo ([in] ULONG_PTR pAgentStreamInfo);
	[] HRESULT GetBkColor ([out] COLORREF* pBkColor);
	[] HRESULT SetBkColor ([in] const COLORREF* pBkColor);
	[] HRESULT SegmentDurationChanged ();
};

/////////////////////////////////////////////////////////////////////////////

const DWORD	RenderSmoothEdges = 0x00000001;
const DWORD	RenderSmoothAll = 0x00000002;

[uuid(1147E568-A208-11DE-ABF2-002421116FB2), object, hidden]
interface _IAgentStreamRender : IUnknown
{
	[] HRESULT GetRenderWnd ([out] HWND * pRenderWnd);
	[] HRESULT SetRenderWnd ([in] HWND pRenderWnd);
	[] HRESULT GetBkColor ([out] COLORREF* pBkColor);
	[] HRESULT SetBkColor ([in] const COLORREF* pBkColor);
	[] HRESULT GetSmoothing ([out] DWORD* pSmoothing);
	[] HRESULT SetSmoothing ([in] DWORD pSmoothing);
	[] HRESULT GetImageSize ([out] long* pImageWidth, [out] long* pImageHeight);
	[] HRESULT DrawSampleImage ([in, defaultvalue(0)] HDC pDC, [in, defaultvalue(0)] const RECT * pTargetRect);
};

/////////////////////////////////////////////////////////////////////////////

//{{AFX_APPEND_ODL}}
//}}AFX_APPEND_ODL}}
