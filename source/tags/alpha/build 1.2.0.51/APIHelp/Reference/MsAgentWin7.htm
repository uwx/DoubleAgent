<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
	<title>Microsoft Agent on Windows 7</title>
	<link rel="STYLESHEET" href="../css/dahelp.css" />
	<xml>
		<MSHelp:TOCTitle Title="Microsoft Agent on Windows 7" />
		<MSHelp:Keyword Index="K" Term="Microsoft Agent on Windows 7" />
		<MSHelp:Attr Name="TopicType" Value="kbOrient" />
		<MSHelp:Attr Name="TopicType" Value="apiref" />
		<MSHelp:Attr Name="DocSet" Value="DoubleAgent" />
		<MSHelp:Attr Name="DocSet" Value="NETFramework" />
		<MSHelp:Attr Name="DocSet" Value="WindowsForms" />
		<MSHelp:Attr Name="DocSet" Value="C#" />
		<MSHelp:Attr Name="DocSet" Value="Visual Basic" />
		<MSHelp:Attr Name="DocSet" Value="ExpressLibVS" />
		<MSHelp:Attr Name="Technology" Value="Agent" />
		<MSHelp:Attr Name="Technology" Value="ManagedCode" />
		<MSHelp:Attr Name="Technology" Value="ActiveX" />
		<MSHelp:Attr Name="Technology" Value="WindowsForms" />
		<MSHelp:Attr Name="Technology" Value="kb3Ptech" />
		<MSHelp:Attr Name="ProgModel" Value="managed" />
		<MSHelp:Attr Name="TargetOS" Value="Windows" />
	</xml>
</head>
<body>
	<table class="pagetable" cellspacing="0" cellpadding="0">
		<tr>
			<td class="runninghead">Double&nbsp;Agent&nbsp;SDK</td>
		</tr>
		<tr>
			<td class="pagehead">
				<h3>Microsoft<sup>®</sup> Agent on Windows&trade; 7</h3>
			</td>
		</tr>
		<tr>
			<td class="page">
				<p>If you install Microsoft<sup>®</sup> Agent on Windows 7 using the <a target="_blank" href="http://support.microsoft.com/Default.aspx?kbid=969168">
				KB969168</a> hotfix, it&#39;s installed using Windows Resource Protection. This means that it&#39;s treated
					as part of Windows, and no aspect of its installation can be changed (except by Microsoft). Therefore,
					if you install both the Microsoft<sup>®</sup> Agent hotfix and Double Agent:</p>
				<ul>
					<li>The Microsoft<sup>®</sup> Agent hotfix <b>must</b> be installed <b>before</b> Double Agent. If you&#39;ve
						already installed Double Agent, you must remove it <b>before</b> installing the Microsoft<sup>®</sup>
						Agent hotfix. You can reinstall Double Agent after the hotfix is installed.</li>
					<li>If you install the Microsoft<sup>®</sup> Agent hotfix while Double Agent is installed, you must remove
						the hotfix <b>first</b>, then remove Double Agent, then reinstall them in the correct order.</li>
					<li>
						<p>There will be limitations in Double Agent&#39;s ability to emulate Microsoft<sup>®</sup> Agent. This
							is because emulation is achieved by redirecting Microsoft<sup>®</sup> Agent COM classes to Double Agent
							COM classes using the <b>TreatAs</b> registry entry. However, the Microsoft<sup>®</sup> Agent registration
							in the <code class="inline">HKEY_LOCAL_MACHINE</code> registry hive cannot be changed, so the <b>TreatAs</b>
							redirection can only be set in the <code class="inline">HKEY_CURRENT_USER</code> registry hive.</p>
						<p>When you use the Double Agent control panel to enable Microsoft<sup>®</sup> Agent emulation, it can only
							apply to the <b>current</b> user. In addition, any application that runs with elevated permissions (i.e.
							&quot;as administrator&quot;) will <b>not</b> recognize the emulation (because elevated processes ignore
							per-user COM configuration).</p>
					</li>
				</ul>
			</td>
		</tr>
	</table>
</body>
</html>
