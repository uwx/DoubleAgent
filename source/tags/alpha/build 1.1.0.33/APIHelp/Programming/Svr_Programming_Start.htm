<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Adding Microsoft Agent Functionality to Your Application</TITLE>
<!-- Built on Monday, August 06, 2001 -->
<SCRIPT SRC="../langref.js"></SCRIPT>
<LINK REL="STYLESHEET" HREF="../css/dahelp.css"></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0><TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Platform&nbsp;SDK:&nbsp;Agent</TD></TR></TABLE>

<H2><A NAME="_agent_adding_microsoft_agent_functionality_to_your_application_paface"></A>Adding Microsoft Agent Functionality to Your Application</H2>

<P>To access Microsoft Agent's server interfaces, Agent must already be installed on the target system. If you want to install Microsoft Agent as part of your application, you must have a valid distribution license for Agent. You can access the license agreement from the Microsoft Agent Web site, (<A HREF="http://www.microsoft.com/msagent/licensing.htm">http://www.microsoft.com/msagent/licensing.htm</A>). You can then download Agent's self-installing executable file from the Web site (using the Save rather than Run option). You can include this file in your installation setup program. Whenever it is executed, it will automatically install Agent on the target system. For further details on installation, see the Microsoft Agent distribution license agreement. Installation other than using Agent's self-installing executable file, such as attempting to copy and register Agent component files, is not supported. This ensures consistent and complete installation. Note that the Microsoft Agent self-installing file will not install on Microsoft Windows® 2000 and later operating systems because these versions of the operating system already include their own version of Agent.</P>

<P>To successfully install Agent on a target system with a prior Microsoft Win32® operating system, you must also ensure that the target system has a recent version of the Microsoft Visual C++ runtime (Msvcrt.dll), Microsoft registration tool (Regsvr32.dll), and Microsoft COM dlls. The easiest way to ensure that the necessary components are on the target system is to require that Microsoft Internet Explorer 3.02 or later is installed. Alternatively, you can install the first two components which are available as part of Microsoft Visual C++. The necessary COM dlls can be installed as part of the Microsoft DCOM update, available at the Microsoft Web site. You can find further information and licensing information for these components at the Microsoft Web site.</P>

<P>Agent's language components can be installed the same way. Similarly, you can use this technique to install the ACS format of the Microsoft characters available for distribution from the Microsoft Agent Web site. The character files automatically install to the Microsoft Agent \Chars subdirectory.</P>

<P>Because Microsoft Agent's components are designed as operating system components, Agent may not be uninstalled. Similarly, where Agent is already installed as part of the Windows operating system, the Agent self-installing cabinet may not install.</p>

<P>Once installed, to call Agent's interfaces, create an instance of the server and request a pointer to a specific interface that the server supports using the standard COM convention. In particular, the COM library provides an API function, <B>CoCreateInstance</B>, that creates an instance of the object and returns a pointer to the requested interface of the object. Request a pointer to the <B>IAgent</B> or <B>IAgentEx</B> interface in your <B>CoCreateInstance</B> call or in a subsequent call to <B>QueryInterface</B>.</P>

<P>The following code illustrates this in C/C++:</P>

<PRE>hRes = CoCreateInstance(CLSID_AgentServer,
                     NULL,
                     CLSCTX_SERVER,
                     IID_IAgentEx,
                     (LPVOID *)&amp;pAgentEx);</PRE>

<P>If the Microsoft Agent server is running, this function connects to the server; otherwise, it starts up the server.</P>

<P>Note that the Microsoft Agent server interfaces often include extended interfaces that include an "Ex" suffix. These interfaces are derived from, and therefore include all the functionality of, their non-Ex counterparts. If you want to use any of the extended features, use the Ex interfaces.</P>

<P>Functions that take pointers to BSTRs allocate memory using <B>SysAllocString</B>. It is the caller's responsibility to free this memory using <B>SysFreeString</B>.</P>
<!-- Info Task Footer -->
<DIV CLASS="itfBorder"><IMG SRC="../tiny.gif" WIDTH="1" HEIGHT="1"></DIV>
<DIV CLASS="itf"><B>Platform SDK Release: <FONT COLOR="#ddaa00">August 2001</FONT></B>
<TABLE CELLPADDING="0" CELLSPACING="0"><TR VALIGN="top">
<TD WIDTH="13" CLASS="itficon"><A HREF="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20Adding%20Microsoft%20Agent%20Functionality%20to%20Your%20Application;%20RELEASE:%20August%202001;%20URL:%20paface_20md.htm" Title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com"><IMG SRC="../sendfdbk.gif" BORDER="0" WIDTH="13" HEIGHT="15"/></A></TD>
<TD WIDTH="47%" CLASS="itf">What did you think of this topic?<BR>
<A HREF="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20Adding%20Microsoft%20Agent%20Functionality%20to%20Your%20Application;%20RELEASE:%20August%202001;%20URL:%20paface_20md.htm" Title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com">Let us know</A>.</TD>
<TD WIDTH="16" CLASS="itficon"><IMG SRC="../download.gif" BORDER="0" WIDTH="16" HEIGHT="16"/></TD>
<TD CLASS="itf">Order a Platform SDK CD Online<BR>
(<A HREF="http://developerstore.com/devstore/product.asp?productID=7639&Store=TOOLBOX_NA&DisplayCode" TARGET="_blank" TITLE="Order a CD online.">U.S/Canada</A>)&nbsp;&nbsp;&nbsp;(<A HREF="http://developerstore.com/devstore/product.asp?productID=7639&Store=TOOLBOX_INTL&DisplayCode" TARGET="_blank" TITLE="Order a CD online.">International</A>)</TD></TR></TABLE></DIV>
<P>&nbsp;</P>

</BODY>
</HTML>
