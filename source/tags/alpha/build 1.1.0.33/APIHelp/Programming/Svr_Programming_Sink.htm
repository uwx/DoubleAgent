<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML DIR="LTR"><HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Creating a Notification Sink</TITLE>
<!-- Built on Monday, August 06, 2001 -->
<SCRIPT SRC="../langref.js"></SCRIPT>
<LINK REL="STYLESHEET" HREF="../css/dahelp.css"></HEAD>
<BODY TOPMARGIN="0">

<TABLE CLASS="buttonbarshade" CELLSPACING=0><TR><TD>&nbsp;</TD></TR></TABLE>
<TABLE CLASS="buttonbartable" CELLSPACING=0><TR ID="hdr"><TD CLASS="runninghead" NOWRAP>Platform&nbsp;SDK:&nbsp;Agent</TD></TR></TABLE>

<H2><A NAME="_agent_creating_a_notification_sink_paface"></A>Creating a Notification Sink</H2>

<P>To be notified of events by Microsoft Agent, you must implement either the <B>IAgentNotifySink </B>or the <B>IAgentNotifySinkEx</B> interface, and create and register an object of that type following COM conventions:</P>

<PRE>// Create a notification sink

pSinkEx = new AgentNotifySinkEx;

pSinkEx-&gt;AddRef();

// And register it with Microsoft Agent

hRes = pAgentEx-&gt;Register((IUnknown *)pSinkEx, &amp;lNotifySinkID);</PRE>

<P>Remember to unregister your notification sink when your application shuts down and releases Microsoft Agent's interfaces.</P>
<!-- Info Task Footer -->
<DIV CLASS="itfBorder"><IMG SRC="../tiny.gif" WIDTH="1" HEIGHT="1"></DIV>
<DIV CLASS="itf"><B>Platform SDK Release: <FONT COLOR="#ddaa00">August 2001</FONT></B>
<TABLE CELLPADDING="0" CELLSPACING="0"><TR VALIGN="top">
<TD WIDTH="13" CLASS="itficon"><A HREF="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20Creating%20a%20Notification%20Sink;%20RELEASE:%20August%202001;%20URL:%20paface_0ahx.htm" Title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com"><IMG SRC="../sendfdbk.gif" BORDER="0" WIDTH="13" HEIGHT="15"/></A></TD>
<TD WIDTH="47%" CLASS="itf">What did you think of this topic?<BR>
<A HREF="mailto:sdkfdbk@microsoft.com?subject=TITLE:%20Creating%20a%20Notification%20Sink;%20RELEASE:%20August%202001;%20URL:%20paface_0ahx.htm" Title="Send feedback to the Platform SDK team at sdkfdbk@microsoft.com">Let us know</A>.</TD>
<TD WIDTH="16" CLASS="itficon"><IMG SRC="../download.gif" BORDER="0" WIDTH="16" HEIGHT="16"/></TD>
<TD CLASS="itf">Order a Platform SDK CD Online<BR>
(<A HREF="http://developerstore.com/devstore/product.asp?productID=7639&Store=TOOLBOX_NA&DisplayCode" TARGET="_blank" TITLE="Order a CD online.">U.S/Canada</A>)&nbsp;&nbsp;&nbsp;(<A HREF="http://developerstore.com/devstore/product.asp?productID=7639&Store=TOOLBOX_INTL&DisplayCode" TARGET="_blank" TITLE="Order a CD online.">International</A>)</TD></TR></TABLE></DIV>
<P>&nbsp;</P>

</BODY>
</HTML>
