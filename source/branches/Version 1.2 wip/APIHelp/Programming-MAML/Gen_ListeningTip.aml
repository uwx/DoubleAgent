<?xml version="1.0" encoding="utf-8"?>
<topic id="e0846718-419c-11e1-9d4f-002421116fb2" revisionNumber="1">
	<developerConceptualDocument
	  xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
	  xmlns:xlink="http://www.w3.org/1999/xlink">

		<introduction>
			<para>
				The <token>ListeningTip</token> is another speech input service provided by <token>DA</token>. When
				speech input is installed, <token>DA</token> includes a special tooltip window that appears when the user presses
				the <token>ListeningKey</token> or calls the <unmanagedCodeEntityReference>Listen</unmanagedCodeEntityReference> method. The
				<token>ListeningTip</token> appears only when the speech services are available. If no client
				has authored a voice command or successfully loads a speech engine, the <token>ListeningTip</token>
				does not appear. Further, both speech input and the <ui>&quot;Display listening tips&quot;</ui>
				option in the <link xlink:href="e08466be-419c-11e1-9d4f-002421116fb2">
					<token>AdvancedCharacterOptions</token>
				</link> window must be enabled
				for the tip to appear.
			</para>
		</introduction>
		<section>
			<content>
				<para>
					The following table summarizes the display of the <token>ListeningTip</token> when speech recognition
					is enabled.
				</para>
				<para/>
				<table>
					<row>
						<entry>
							<para>
								The user presses the <token>ListeningKey</token>, or the
								<link xlink:href="e0846714-419c-11e1-9d4f-002421116fb2#Active">
									<token>InputActive</token>
								</link>
								client calls the <unmanagedCodeEntityReference>Listen</unmanagedCodeEntityReference> method
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								The <token>ListeningTip</token> appears below the active client's character and
								displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>
								for "<placeholder>InputActiveClient.Commands.VoiceCaption</placeholder>" commands.
							</para>
							<para>
								If the client hasn't defined a <unmanagedCodeEntityReference>VoiceCaption</unmanagedCodeEntityReference> for its
								<unmanagedCodeEntityReference>Commands</unmanagedCodeEntityReference> object, the value of its <unmanagedCodeEntityReference>Caption</unmanagedCodeEntityReference> property
								is used.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the <link xlink:href="e0846714-419c-11e1-9d4f-002421116fb2#Active">
									<token>InputActive</token>
								</link> client of the character does not
								have a <unmanagedCodeEntityReference>Caption</unmanagedCodeEntityReference> or defined <unmanagedCodeEntityReference>VoiceGrammar</unmanagedCodeEntityReference> for its <unmanagedCodeEntityReference>Commands</unmanagedCodeEntityReference> object, the <token>ListeningTip</token> displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>for commands.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If there are no visible characters, the <token>ListeningTip</token> appears adjacent to the
								character's taskbar icon and displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>Say the name of a character to display it.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the speech recognition is still initializing, the <token>ListeningTip</token> displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is preparing to listen --
							</para>
							<para>Please wait to speak.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the audio channel is busy, as when the character is audibly speaking or some other application is
								using the audio channel, the <token>ListeningTip</token> displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is not listening --
							</para>
							<para>
								for <placeholder>InputActiveClient.Commands.VoiceCaption</placeholder> commands.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If there is no language-compatible speech engine installed for the
								<link xlink:href="e0846714-419c-11e1-9d4f-002421116fb2#Active">
									<token>InputActive</token>
								</link> client's character,
								the <token>ListeningTip</token> displays the following, where
								<placeholder>Language</placeholder> represents the selected language of the character:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is not listening --
							</para>
							<para>
								Speech input is not available in <placeholder>Language</placeholder>.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the audio device is not available for other reasons, such as when it is busy or there is some error
								in attempting to open the audio device, the following tip appears when the <token>ListeningMode</token> is
								activated:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is not listening --
							</para>
							<para>Speech input not available.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the <link xlink:href="e0846714-419c-11e1-9d4f-002421116fb2#Active">
									<token>InputActive</token>
								</link> client application has not defined
								any <legacyItalic>Voice</legacyItalic> settings for its commands,
								and has also disabled <legacyItalic>Global Voice Commands</legacyItalic>,
								this tip appears:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is not listening --
							</para>
							<para>No voice commands.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If all characters are hidden, the <token>ListeningTip</token> displays the following text:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>Say the name of a character to display it.</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>The user speaks a voice command</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								If the spoken text matches a client-defined or pre-defined command, the <token>ListeningTip</token>
								appears below the active client's character and displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>
								Heard "<placeholder>CommandText</placeholder>"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								However, when a recognition is received and the <token>ListeningMode</token>
								has timed out, but the <token>ListeningTip</token> has not timed out, or if the <token>ListeningMode</token> is still in effect,
								but the audio channel is not yet available (for example, the user is still holding the <token>ListeningKey</token>,
								or the <token>ListeningMode</token> has not timed out because the character is speaking), the <token>ListeningTip</token> displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is not listening --
							</para>
							<para>
								Heard "<placeholder>text heard</placeholder>"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								When the spoken text matches a defined command, but <token>DA</token> does not act on
								it because the command has a low confidence score, the the <token>ListeningTip</token> displays:
							</para>
						</entry>
						<entry>
							<para>
								-- <placeholder>CharacterName</placeholder> is listening --
							</para>
							<para>Didn't understand your request.</para>
						</entry>
					</row>
					<row>
						<entry></entry>
						<entry>
							<para>
								The first line identifying the character is centered. The second line is left
								justified and breaks to a third line when it exceeds the <token>ListeningTip</token>'s maximum
								width.
							</para>
						</entry>
					</row>
				</table>
				<para/>
				<para>
					The <token>ListeningTip</token> automatically times out after being presented. If the "Heard"
					text time-out completes while the user is still holding down the <token>ListeningKey</token>, the tip reverts
					to the "listening" text unless <token>DA</token> receives another matching utterance. In this case, the tip
					displays the new "Heard" text and begins the time-out for that tip text. If the user releases the
					<token>ListeningKey</token> and <token>DA</token> is displaying the "Heard" text,
					the time-out continues and the <token>ListeningTip</token> window is hidden when the time-out interval elapses.
				</para>
				<para>
					If <token>DA</token> has not yet attempted to load a speech recognition engine, the <token>ListeningTip</token>
					will not display. Similarly, if the user has disabled the display of the <token>ListeningTip</token>
					or disabled speech input in the <link xlink:href="e0846716-419c-11e1-9d4f-002421116fb2#PropSheet">
						<token>AdvancedCharacterOptions</token>
					</link>
					window, the <token>ListeningTip</token> will not be displayed.
				</para>
				<para>
					Client applications cannot write directly to the <token>ListeningTip</token>, but you can specify
					alternative text that <token>DA</token> displays on recognition of a matching voice command. To do this,
					set the <unmanagedCodeEntityReference>Confidence</unmanagedCodeEntityReference> property and the <unmanagedCodeEntityReference>ConfidenceText</unmanagedCodeEntityReference>
					property for the command. If spoken input matches the command, but the best match does not exceed the
					confidence setting, <token>DA</token> uses the text set in the <unmanagedCodeEntityReference>ConfidenceText</unmanagedCodeEntityReference> property
					in the tip window. If the client does not supply this value, <token>DA</token> displays the text (grammar)
					it matched.
				</para>
				<para>
					The <token>ListeningTip</token> text appears in the language based on the
					<link xlink:href="e0846714-419c-11e1-9d4f-002421116fb2#Active">
						<token>InputActive</token>
					</link> client's character
					<unmanagedCodeEntityReference>LanguageID</unmanagedCodeEntityReference> setting, regardless of whether there
					is a language-compatible speech recognition engine available.
				</para>
			</content>
		</section>

		<relatedTopics>
		</relatedTopics>

	</developerConceptualDocument>
</topic>
