<?xml version="1.0" encoding="utf-8"?>
<topic id="e0846714-419c-11e1-9d4f-002421116fb2" revisionNumber="1">
	<developerConceptualDocument
	  xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
	  xmlns:xlink="http://www.w3.org/1999/xlink">

		<introduction>
			<para>
				A client application provides the primary user interface for interaction with a character. You can program
				a character to respond to any form of input, from button-clicks to typed-in text. In addition, Double
				Agent provides events so you can program what happens when the user clicks, double-clicks, or drags
				the character. Double Agent passes the coordinates of the pointer and any modifier key state for these
				events.
			</para>
			<autoOutline/>
		</introduction>

		<section address="Active">
			<title>
				<token>InputActiveUc</token> Client
			</title>
			<content>
				<para>
					Because multiple client applications can share the same character and because multiple clients can use
					different characters at the same time, the server designates one client as the <token>InputActive</token>
					client and sends mouse and voice input only to that client application. This maintains the orderly management
					of user input, so that an appropriate client responds to the input.
				</para>
				<para>
					Typically, user interaction determines which client application becomes <token>InputActive</token>.
					For example, if the user clicks a character, that character's client application becomes <token>InputActive</token>.
					Similarly, if a user speaks the name of a character, it becomes <token>InputActive</token>.
					Also, when the server processes a character's <unmanagedCodeEntityReference>Show</unmanagedCodeEntityReference> method, the client of that
					character becomes <token>InputActive</token>.
				</para>
				<para>
					When a character is hidden, the client of that character will no longer be <token>InputActive</token>
					for that character. The server automatically makes the <legacyItalic>active</legacyItalic> client of any remaining
					character(s) <token>InputActive</token>. When all characters are hidden, no client is <token>InputActive</token>.
					However, in this situation, if the user presses the <token>ListeningKey</token>,
					Double Agent will continue to listen for its commands (using the speech recognition engine matching
					the topmost character of the last <token>InputActive</token> client).
				</para>
				<para>
					If multiple clients are sharing the same character, the server will designate its <legacyItalic>active</legacyItalic>
					client as <token>InputActive</token> client. The <legacyItalic>active</legacyItalic> character is the
					topmost in the client order. You can set your client to be the <legacyItalic>active</legacyItalic> or
					<legacyItalic>not-active</legacyItalic> client using the
					<unmanagedCodeEntityReference>Activate</unmanagedCodeEntityReference> method. You can also use the
					<unmanagedCodeEntityReference>Activate</unmanagedCodeEntityReference> method to explicitly make your client <token>InputActive</token>;
					but to avoid disrupting other clients of the character, you should do so only when your client application
					is <legacyItalic>active</legacyItalic>. For example, if the user clicks your application's window, activating
					your application, you can call the <unmanagedCodeEntityReference>Activate</unmanagedCodeEntityReference> method to receive and process mouse
					and speech input from the character.
				</para>

			</content>
		</section>

		<section address="Menu">
			<title>
				<token>PopupMenuUc</token> Support
			</title>
			<content>
				<para>
					Double Agent includes a <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Menu">
						<token>PopupMenu</token>
					</link> (also known as a context menu) for each character.
					Double Agent displays this <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Menu">
						<token>PopupMenu</token>
					</link> automatically when a user right-clicks
					the character. You can add commands for your client application to the menu by defining a <unmanagedCodeEntityReference>
						Commands
					</unmanagedCodeEntityReference> collection. For each command in the collection that you define, you can specify <unmanagedCodeEntityReference>
						Caption
					</unmanagedCodeEntityReference> and <unmanagedCodeEntityReference>Visible</unmanagedCodeEntityReference> properties. The <unmanagedCodeEntityReference>Caption</unmanagedCodeEntityReference>
					is the text that appears in the menu when the <unmanagedCodeEntityReference>Visible</unmanagedCodeEntityReference> property is set to <literal>True</literal>. You can also use the <unmanagedCodeEntityReference>Enabled</unmanagedCodeEntityReference> property to display
					the command in the menu as disabled. Define the access key for the menu text by including an ampersand
					(&amp;) before the text character of the <unmanagedCodeEntityReference>Caption</unmanagedCodeEntityReference> text setting.
				</para>
				<para>
					Double Agent automatically adds to the menu commands for opening the <link xlink:href="e0846717-419c-11e1-9d4f-002421116fb2">
						<token>VoiceCommands</token>
					</link> window and hiding the character as well as the <unmanagedCodeEntityReference>Commands</unmanagedCodeEntityReference> captions
					of other clients of the character to enable users to switch between clients. Double Agent automatically
					adds a separator to the menu between its menu entries and those defined by the client. Separators appear
					only when there are items in the menu to separate.
				</para>
				<para>
					To remove commands from a menu, use the <unmanagedCodeEntityReference>Remove</unmanagedCodeEntityReference> method. Note that menu entries
					do not change while the menu displays. If you add or remove commands or change their properties, the
					menu displays the changes when the user redisplays the menu.
				</para>
				<para>
					If you prefer to provide your own <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Menu">
						<token>PopupMenu</token>
					</link> services for a character, you can
					use the <unmanagedCodeEntityReference>AutoPopupMenu</unmanagedCodeEntityReference> property to turn off automatic handling of the right-click
					action. You can then use the <unmanagedCodeEntityReference>Click</unmanagedCodeEntityReference> event notification to author your own menu
					handling behaviour.
				</para>
				<para>
					When the user selects a command from a character's <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Menu">
						<token>PopupMenu</token>
					</link> or the <link xlink:href="e0846717-419c-11e1-9d4f-002421116fb2">
						<token>VoiceCommands</token>
					</link> window, Double Agent triggers the <unmanagedCodeEntityReference>Command</unmanagedCodeEntityReference> event of the associated
					client and passes back the parameters of the input using the <unmanagedCodeEntityReference>UserInput</unmanagedCodeEntityReference> object.
				</para>
				<para>
					Double Agent also provides a <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Menu">
						<token>PopupMenu</token>
					</link> for the character's <link xlink:href="e08466bc-419c-11e1-9d4f-002421116fb2#Icon">
						<token>NotificationIcon</token>
					</link>.
					When the character is visible, right-clicking this menu displays the same commands as those displayed
					by right-clicking the character. However, when the character is hidden, only the pre-defined commands
					are included.
				</para>
			</content>
		</section>

		<relatedTopics>
			<link xlink:href="e0846715-419c-11e1-9d4f-002421116fb2" />
			<link xlink:href="e0846717-419c-11e1-9d4f-002421116fb2" />
			<link xlink:href="e0846718-419c-11e1-9d4f-002421116fb2" />
		</relatedTopics>

	</developerConceptualDocument>
</topic>
