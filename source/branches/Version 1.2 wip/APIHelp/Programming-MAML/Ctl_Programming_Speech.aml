<?xml version="1.0" encoding="utf-8"?>
<topic id="e0846739-419c-11e1-9d4f-002421116fb2" revisionNumber="1">
	<developerHowToDocument
	  xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
	  xmlns:xlink="http://www.w3.org/1999/xlink">

		<introduction>
			<para>
				Although Double Agent includes support for synthesized speech output, a compatible text-to-speech (TTS)
				speech engine must be installed to access Double Agent's speech output features. Similarly, if you want
				to use Double Agent's speech features to support speech input for a character, you must install a compatible
				command-and-control speech recognition engine.
			</para>
			<para>
				To produce text-to-speech output, use the <codeEntityReference qualifyHint="false">M:DoubleAgent.Control.Character.Speak</codeEntityReference>
				method. Double Agent will automatically attempt to load an engine that matches the character's
				<codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.LanguageID</codeEntityReference>.
				If the character's definition includes a specific <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.TTSModeID</codeEntityReference>
				and that engine is available and matches the character's <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.LanguageID</codeEntityReference>,
				Double Agent loads that engine for the character. If not, Double Agent loads the first
				TTS engine that <token>SAPI</token> returns as matching the character's language setting. You can also use the
				<codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.TTSModeID</codeEntityReference>
				property to load a specific engine.
				The <codeEntityReference qualifyHint="false">T:DoubleAgent.Control.TTSEngines</codeEntityReference>
				collection will
				help you determine which engines are available and which ones are compatible with the character.
			</para>
			<para>
				To enable speech input support in your application, define a
				<codeEntityReference qualifyHint="false">T:DoubleAgent.Control.Command</codeEntityReference>
				object and set its <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Command.VoiceCaption</codeEntityReference>
				property. Double Agent will automatically load speech services, so that when the user
				presses the <token>ListeningKey</token> or you call
				<codeEntityReference qualifyHint="false">M:DoubleAgent.Control.Character.Listen</codeEntityReference>,
				the speech recognition engine will be loaded. By default the character's
				<codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.LanguageID</codeEntityReference>
				will determine which engine is loaded.
				Double Agent attempts to load the first engine that the <token>SAPIname</token> (<token>SAPI</token>) returns
				as matching this language. Use the <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.SRModeID</codeEntityReference>
				property if you want to load a specific engine. The <codeEntityReference qualifyHint="false">T:DoubleAgent.Control.SREngines</codeEntityReference>
				collection will help you determine which engines are available and which ones are compatible
				with the character.
			</para>
			<para>
				Typically, Double Agent loads a text-to-speech engine when <codeEntityReference qualifyHint="false">M:DoubleAgent.Control.Character.Speak</codeEntityReference>
				is first called and a speech recognition when the <token>ListeningMode</token> is
				initiated. However, if you want to preload the speech engine, you can query the properties related to
				the speech interfaces. For example, querying <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.TTSModeID</codeEntityReference>
				or <codeEntityReference qualifyHint="false">P:DoubleAgent.Control.Character.SRModeID</codeEntityReference>
				will attempt to load that type of engine.
			</para>
			<para>
				Because Double Agent's speech features are based on the <token>SAPIname</token>, you can use
				any engines that support the required speech interfaces. The Double Agent 32-bit build supports <token>SAPIname</token>
				 (<token>SAPI</token>) versions 4 and 5 for text-to-speech and version 5 for speech recognition. The Double Agent
				64-bit build supports only version 5 for both text-to-speech and speech recognition.
			</para>
		</introduction>

		<relatedTopics>
			<link xlink:href="e0846731-419c-11e1-9d4f-002421116fb2" />
		</relatedTopics>

	</developerHowToDocument>
</topic>
