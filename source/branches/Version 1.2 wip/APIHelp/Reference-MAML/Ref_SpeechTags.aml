<?xml version="1.0" encoding="utf-8"?>
<topic id="e08466ca-419c-11e1-9d4f-002421116fb2" revisionNumber="1">
	<developerReferenceWithoutSyntaxDocument
	  xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
	  xmlns:xlink="http://www.w3.org/1999/xlink">

		<introduction>
			<para>
				Double Agent allows client applications to modify speech output through special tags inserted in the
				speech text string. These tags help you change the character's spoken output characteristics.
			</para>
		</introduction>

		<section address="SAPI5">
			<title>
				<token>SAPI5name</token> (<token>SAPI5</token>)
			</title>
			<content>
				<para>
					<token>SAPI5</token> synthesis markup is an application of <legacyItalic>XML</legacyItalic>.
				</para>
				<list class="bullet">
					<listItem>
						<para>
							Every <legacyItalic>XML</legacyItalic> element consists of a start tag <legacyItalic>&lt;Some_tag&gt;</legacyItalic>
							and an end tag <legacyItalic>&lt;/Some_tag&gt;</legacyItalic> with a case-insensitive tag name and contents
							between these tags. If the element is empty <legacyItalic>&lt;Some_tag&gt;&lt;/Some_tag&gt;</legacyItalic>,
							it has no contents and the start tag and the end tag might be the same <legacyItalic>&lt;Some_tag/&gt;</legacyItalic>.
						</para>
					</listItem>
					<listItem>
						<para>
							Attributes of an <legacyItalic>XML</legacyItalic> element appear inside the start tag. Each attribute is
							in the form of a name, followed by an equal character, followed by a quoted <legacyItalic>literal</legacyItalic>
							string value. An attribute of a given name may only appear once in a start tag.
						</para>
					</listItem>
					<listItem>
						<para>
							The <legacyItalic>literal</legacyItalic> string cannot contain a less than character (&lt;). If the string
							is surrounded by single quotation marks, it cannot contain a single quotation mark. If the string is
							surrounded by double quotation marks it cannot contain a double quotation mark. Furthermore, an ampersand
							(&amp;) can be used only in an entity reference such as <legacyItalic>&amp;amp;</legacyItalic> and
							<legacyItalic>&amp;gt;</legacyItalic>.
							When a <legacyItalic>literal</legacyItalic> string is parsed, an entity reference such
							as <legacyItalic>&amp;gt;</legacyItalic> is resolved to its corresponding text, such as &quot;&gt;&quot;.
						</para>
					</listItem>
				</list>
				<para>
					The following <token>SAPI5</token> tags are supported:
				</para>


				<table>
					<tableHeader>
						<row>
							<entry>Tag</entry>
							<entry>Description</entry>
							<entry>Syntax</entry>
						</row>
					</tableHeader>
					<row>
						<entry address="Bookmark">
							<para>
								<languageKeyword>Bookmark</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Defines a bookmark in the spoken text.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Bookmark</languageKeyword>&#160;<languageKeyword>MARK</languageKeyword>="<placeholder>number</placeholder>" /&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										A numeric value that identifies the bookmark (from 1 to 2147483645).
									</entry>
								</row>
							</table>
							<para>
								When the speech engine processes a bookmark, Double Agent generates a <placeholder>Bookmark</placeholder>
								event.
							</para>
						</entry>
					</row>
					<row>
						<entry address="Context">
							<para>
								<languageKeyword>Context</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>The context can specify the type of normalization rules which should be applied to the contained text.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Context</languageKeyword>&#160;<languageKeyword>ID</languageKeyword>="<placeholder>
									<link xlink:href="e08466cb-419c-11e1-9d4f-002421116fb2">string</link>
								</placeholder>"&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Context</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>string</placeholder>
									</entry>
									<entry>
										The <link xlink:href="e08466cb-419c-11e1-9d4f-002421116fb2">normalization context</link> name.
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									<entry>
										The speech to be normalized according to the specified context.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Emph">
							<para>
								<languageKeyword>Emph</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Places emphasis on the words contained by this element.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Emph</languageKeyword>&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Emph</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									<entry>
										The speech text to emphasize.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Pitch">
							<para>
								<languageKeyword>Pitch</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Modifies the pitch of the text contained by this element.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Pitch</languageKeyword>&#160;<languageKeyword>MIDDLE</languageKeyword>|<languageKeyword>ABSMIDDLE</languageKeyword>="<placeholder>number</placeholder>"&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Pitch</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
										(<languageKeyword>MIDDLE</languageKeyword>)
									</entry>
									<entry>
										<definitionTable>
											<definedTerm>-24</definedTerm>
											<definition>One octave lower than the current pitch</definition>
											<definedTerm>-10</definedTerm>
											<definition>3/4 the current pitch</definition>
											<definedTerm>[+]10</definedTerm>
											<definition>4/3 the current pitch</definition>
											<definedTerm>[+]24</definedTerm>
											<definition>One octave higher than the current pitch</definition>
										</definitionTable>
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>number</placeholder>
										(<languageKeyword>ABSMIDDLE</languageKeyword>)
									</entry>
									<entry>
										<definitionTable>
											<definedTerm>-24</definedTerm>
											<definition>One octave lower than the default pitch</definition>
											<definedTerm>-10</definedTerm>
											<definition>3/4 the default pitch</definition>
											<definedTerm>0</definedTerm>
											<definition>The default pitch</definition>
											<definedTerm>[+]10</definedTerm>
											<definition>4/3 the default pitch</definition>
											<definedTerm>[+]24</definedTerm>
											<definition>One octave higher than the default pitch</definition>
										</definitionTable>
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									<entry>
										The affected speech text.
									</entry>
								</row>
							</table>
							<para>The speech engine may clip the pitch to the maximum or minimum pitch it supports.</para>
						</entry>
					</row>
					<row>
						<entry address="Rate">
							<para>
								<languageKeyword>Rate</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Modifies the speaking rate of the text contained by this element.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Rate</languageKeyword>&#160;<languageKeyword>SPEED</languageKeyword>|<languageKeyword>ABSSPEED</languageKeyword>="<placeholder>number</placeholder>"&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Rate</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
										(<languageKeyword>SPEED</languageKeyword>)
									</entry>
									<entry>
										<definitionTable>
											<definedTerm>-10</definedTerm>
											<definition>1/3 the current rate</definition>
											<definedTerm>[+]10</definedTerm>
											<definition>3 times the current rate</definition>
										</definitionTable>
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>number</placeholder>
										(<languageKeyword>ABSSPEED</languageKeyword>)
									</entry>
									<entry>
										<definitionTable>
											<definedTerm>-10</definedTerm>
											<definition>1/3 the default rate</definition>
											<definedTerm>0</definedTerm>
											<definition>The default rate</definition>
											<definedTerm>[+]10</definedTerm>
											<definition>3 times the default rate</definition>
										</definitionTable>
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									The affected speech text.
								</row>
							</table>
							<para>The speech engine may clip the rate to the maximum or minimum rate it supports.</para>
						</entry>
					</row>
					<row>
						<entry address="Silence">
							<para>
								<languageKeyword>Silence</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Produces silence for a specified number of milliseconds.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Silence</languageKeyword>&#160;<languageKeyword>MSEC</languageKeyword>="<placeholder>number</placeholder>" /&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										The number of milliseconds to pause.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Spell">
							<para>
								<languageKeyword>Spell</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Spells out the words contained by this element, letter by letter.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Spell</languageKeyword>&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Spell</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									<entry>
										Words and numbers are spelled. For words that contain punctuation, such as &quot;U.S.A.&quot;,
										both the punctuation and the letters are spelled.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Volume">
							<para>
								<languageKeyword>Volume</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Modifies the volume of the text contained by this element.</para>
						</entry>
						<entry>
							<para>
								&lt;<languageKeyword>Volume</languageKeyword>&#160;<languageKeyword>LEVEL</languageKeyword>="<placeholder>number</placeholder>"&gt;<placeholder>content</placeholder>&lt;/<languageKeyword>Volume</languageKeyword>&gt;
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										A value from 0 to 100:
										<definitionTable>
											<definedTerm>0</definedTerm>
											<definition>Silent</definition>
											<definedTerm>100</definedTerm>
											<definition>Full volume</definition>
										</definitionTable>
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>content</placeholder>
									</entry>
									<entry>
										The affected speech text.
									</entry>
								</row>
							</table>
						</entry>
					</row>
				</table>

				<para/>
			</content>
		</section>

		<section address="SAPI4">
			<title>
				<token>SAPI4name</token> (<token>SAPI4</token>)
			</title>
			<content>
				<para>
					<token>SAPI4</token> speech output tags use the following syntax rules:
				</para>
				<list class="bullet">
					<listItem>
						<para>All tags begin and end with a backslash character (\).</para>
					</listItem>
					<listItem>
						<para>
							The single backslash character is not allowed within a tag. To include a backslash character in a text
							parameter of a tag, use a double backslash (\\).
						</para>
					</listItem>
					<listItem>
						<para>
							Tags are <legacyItalic>case-insensitive</legacyItalic>. For example, \pit\ is the same as \PIT\.
						</para>
					</listItem>
					<listItem>
						<para>
							Tags are <legacyItalic>whitespace-dependent</legacyItalic>. For example, \Rst\ is <legacyItalic>not</legacyItalic> the same as \&#160;Rst&#160;\.
						</para>
					</listItem>
					<listItem>
						<para>
							Unless otherwise specified or modified by another tag, the speech output retains the characteristic
							set by the tag for the text specified in a single <legacyItalic>Speak</legacyItalic> method. Speech output
							is automatically reset after a <legacyItalic>Speak</legacyItalic> method is completed.
						</para>
					</listItem>
				</list>
				<para>Some tags include quoted strings:</para>
				<list class="bullet">
					<listItem>
						<para>
							For <token>VB</token> and <token>VB</token> Scripting Edition (VBScript), you may have to use two quote marks
							to designate the tag's parameter, or concatenate a double-quote character as part of the string. The
							latter is shown in this <token>VB</token> example:
						</para>
						<code xml:space="preserve" language="vb">
control.Characters("Genie").Speak "This is \map=" + chr(34) + "Spoken text" + chr(34) _
+ "=" + chr(34) + "Balloon text" + chr(34) + "\."
						</code>
					</listItem>
					<listItem>
						<para>For C, C++, and Java™ programming, precede backslashes and double quotes with a backslash. For example:</para>
						<code xml:space="preserve" language="cpp" >
BSTR SpeechText = SysAllocString (L"This is \\map=\"Spoken text\"=\"Balloon text\"\\");
character->Speak (SpeechText, …);
						</code>
					</listItem>
				</list>
				<para>
					The following <token>SAPI4</token> tags are supported:
				</para>

				<table>
					<row>
						<entry>Tag</entry>
						<entry>Description</entry>
						<entry>Syntax</entry>
					</row>
					<row>
						<entry address="Chr">
							<para>
								<languageKeyword>Chr</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Sets the voice's character.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Chr</languageKeyword>=<placeholder>string</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>string</placeholder>
									</entry>
									<entry>
										A string specifying the character of the voice:
										<definitionTable>
											<definedTerm>"Normal"</definedTerm>
											<definition>A normal tone of voice (default)</definition>
											<definedTerm>"Monotone"</definedTerm>
											<definition>A monotone voice</definition>
											<definedTerm>"Whisper"</definedTerm>
											<definition>A whispered voice</definition>
										</definitionTable>
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Ctx">
							<para>
								<languageKeyword>Ctx</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Sets the context of the output text.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Ctx</languageKeyword>=<placeholder>string</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>string</placeholder>
									</entry>
									<entry>
										A string specifying the context of the text that follows, which determines how symbols
										or abbreviations are spoken:
										<definitionTable>
											<definedTerm>"Address"</definedTerm>
											<definition>Addresses and/or phone numbers</definition>
											<definedTerm>"E-mail"</definedTerm>
											<definition>Electronic mail</definition>
											<definedTerm>"Unknown"</definedTerm>
											<definition>The context is unknown (default)</definition>
										</definitionTable>
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Emp">
							<para>
								<languageKeyword>Emp</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Emphasizes the next word spoken. This tag must immediately precede the word.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Emp</languageKeyword>\
							</para>
						</entry>
					</row>
					<row>
						<entry address="Lst">
							<para>
								<languageKeyword>Lst</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Repeats the character's last spoken statement.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Lst</languageKeyword>\
							</para>
						</entry>
					</row>
					<row>
						<entry address="Map">
							<para>
								<languageKeyword>Map</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Maps spoken text to text displayed in the <token>WordBalloon</token>.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Map</languageKeyword>="<placeholder>spokentext</placeholder>"="<placeholder>balloontext</placeholder>"\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>spokentext</placeholder>
									</entry>
									<entry>
										A string specifying the text for spoken output.
									</entry>
								</row>
								<row>
									<entry>
										<placeholder>balloontext</placeholder>
									</entry>
									<entry>
										A string specifying the text for <token>WordBalloon</token> output.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Mrk">
							<para>
								<languageKeyword>Mrk</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Defines a bookmark in the spoken text.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Mrk</languageKeyword>=<placeholder>number</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										A numeric value that identifies the bookmark (from 1 to 2147483645).
									</entry>
								</row>
							</table>
							<para>
								When the speech engine processes a bookmark, Double Agent generates a <legacyItalic>Bookmark</legacyItalic>
								event.
							</para>
						</entry>
					</row>
					<row>
						<entry address="Pau">
							<para>
								<languageKeyword>Pau</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Pauses speech for the specified number of milliseconds.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Pau</languageKeyword>=<placeholder>number</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										The number of milliseconds to pause.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Pit">
							<para>
								<languageKeyword>Pit</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Sets the baseline pitch of the output to the specified value in hertz.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Pit</languageKeyword>=<placeholder>number</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										The pitch in hertz.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Rst">
							<para>
								<languageKeyword>Rst</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Resets all tags to the default settings.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Rst</languageKeyword>\
							</para>
						</entry>
					</row>
					<row>
						<entry address="Spd">
							<para>
								<languageKeyword>Spd</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Sets the baseline average speed of the speech output.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Spd</languageKeyword>=<placeholder>number</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										The baseline average speed, in words per minute.
									</entry>
								</row>
							</table>
						</entry>
					</row>
					<row>
						<entry address="Vol">
							<para>
								<languageKeyword>Vol</languageKeyword>
							</para>
						</entry>
						<entry>
							<para>Sets the baseline volume of the speech output.</para>
						</entry>
						<entry>
							<para>
								\<languageKeyword>Vol</languageKeyword>=<placeholder>number</placeholder>\
							</para>
							<table>
								<tableHeader>
									<row>
										<entry>Part</entry>
										<entry>Description</entry>
									</row>
								</tableHeader>
								<row>
									<entry>
										<placeholder>number</placeholder>
									</entry>
									<entry>
										The baseline volume: 0 is silence and 65535 is maximum volume.
									</entry>
								</row>
							</table>
							<para>The volume setting affects both left and right channels. You cannot set the volume of each channel separately.</para>
						</entry>
					</row>
				</table>
				<alert class="note">
					Note: Double Agent does not support all of the tags documented
					in the <token>SAPIname</token> documentation. Parameters may also vary depending on the TTS engine selected.
					You can set a specific TTS engine using the character's <unmanagedCodeEntityReference>TTSModeID</unmanagedCodeEntityReference> property.
				</alert>

			</content>
		</section>

		<relatedTopics>
			<link xlink:href="e08466cb-419c-11e1-9d4f-002421116fb2" />
		</relatedTopics>

	</developerReferenceWithoutSyntaxDocument>
</topic>
