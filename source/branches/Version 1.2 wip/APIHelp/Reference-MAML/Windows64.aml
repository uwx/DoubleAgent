<?xml version="1.0" encoding="utf-8"?>
<topic id="e08466ce-419c-11e1-9d4f-002421116fb2" revisionNumber="1">
	<developerHowToDocument
	  xmlns="http://ddue.schemas.microsoft.com/authoring/2003/5"
	  xmlns:xlink="http://www.w3.org/1999/xlink">

		<introduction>

			<para>
				If you&#39;re writing a 64-bit <token>Windows</token> application, or you expect your 32-bit application to run in a
				64-bit environment, there are a few special considerations:
			</para>
			<list class="bullet">
				<listItem>
					<para>
						Both the <token>MA</token> and <token>DA</token>&#160;<legacyBold>Servers</legacyBold> are implemented as
						<newTerm>out-of-process</newTerm>&#160;<token>COM</token> servers.
						This means that they&#39;re loaded from a Portable Executable File (.exe) and run in a
						<legacyItalic>different</legacyItalic> process from the client application. Therefore, either a 32-bit or 64-bit application
						can use either the 32-bit or 64-bit server (i.e. the processor architecture of the client and server
						do not need match).
					</para>
				</listItem>
				<listItem>
					<para>
						When your application creates an instance of the <token>Agent</token>&#160;<legacyBold>Server</legacyBold> object, the server architecture
						is chosen as follows:
					</para>
					<table>
						<tableHeader>
							<row>
								<entry>
									<token>Agent</token> Server</entry>
								<entry>Server instance created using</entry>
								<entry>Server architecture</entry>
							</row>
						</tableHeader>
						<row>
							<entry>
								<para>
									<token>MA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>Agent.Server</codeInline> or&#160;<codeInline>Agent.Server.2</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>MA</token>
								</para>
							</entry>
							<entry>
								<para>
									ClassId&#160;<codeInline>{D45FD2FC-5C6E-11D1-9EC1-00C04FD7081F}</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>MA</token>
								</para>
							</entry>
							<entry>
								<para>
									ClassId&#160;<codeInline>{FD0B6205-B0F4-4596-B028-5CDB35D288C1}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Server</codeInline> or <codeInline>DoubleAgent.Server.1.1</codeInline>
								</para>
							</entry>
							<entry>
								<para>Windows decides</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ClassId&#160;<codeInline>{1147E500-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>Windows decides</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ClassId&#160;<codeInline>{1147E500-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
								<para>
									and&#160;<codeInline>CLSCTX_ACTIVATE_64_BIT_SERVER</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit Server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ClassId&#160;<codeInline>{1147E500-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
								<para>
									and&#160;<codeInline>CLSCTX_ACTIVATE_32_BIT_SERVER</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit Server</para>
							</entry>
						</row>
					</table>
				</listItem>
				<listItem>
					<para>
						Both the <token>MA</token> and <token>DA</token>&#160;<token>ActiveXCtls</token> are implemented as
						<newTerm>in-process</newTerm>&#160;<token>COM</token> servers. This means that they&#39;re loaded from a Dynamic Link Library (.dll) and run
						in the <legacyItalic>same</legacyItalic> process as the client application. Therefore, a 32-bit application can only use the
						32-bit <token>ActiveXCtl</token>, and a 64-bit application can only use the 64-bit <token>ActiveXCtl</token>.
					</para>
				</listItem>
				<listItem>
					<para>
						When your application uses the <token>Agent</token>&#160;<token>ActiveXCtl</token>, the server architecture is chosen as follows:
					</para>
					<table>
						<tableHeader>
							<row>
								<entry>
									<token>Agent</token> Control</entry>
								<entry>Control created using</entry>
								<entry>Application architecture</entry>
								<entry>Control architecture</entry>
								<entry>Server architecture</entry>
							</row>
						</tableHeader>
						<row>
							<entry>
								<para>
									<token>MA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>Agent.Control</codeInline> or&#160;<codeInline>Agent.Control.2</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{D45FD31B-5C6E-11D1-9EC1-00C04FD7081F}</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit application</para>
							</entry>
							<entry>
								<para>32-bit control</para>
							</entry>
							<entry>
								<para>32-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>MA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>Agent.Control</codeInline> or&#160;<codeInline>Agent.Control.2</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{D45FD31B-5C6E-11D1-9EC1-00C04FD7081F}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit application</para>
							</entry>
							<entry>
								<para>64-bit control</para>
							</entry>
							<entry>
								<para>32-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit application</para>
								<para>(AutoConnect = 64)</para>
							</entry>
							<entry>
								<para>32-bit control</para>
							</entry>
							<entry>
								<para>64-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit application</para>
								<para>(AutoConnect &#8800; 0)</para>
							</entry>
							<entry>
								<para>32-bit control</para>
							</entry>
							<entry>
								<para>32-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>32-bit application</para>
								<para>(AutoConnect = 0)</para>
							</entry>
							<entry>
								<para>32-bit control</para>
								<para>
									(<token>standalone</token>)
								</para>
							</entry>
							<entry>
								<para>N/A</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit application</para>
								<para>
									(AutoConnect = 32)
								</para>
							</entry>
							<entry>
								<para>64-bit control</para>
							</entry>
							<entry>
								<para>32-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit application</para>
								<para>
									(AutoConnect = 64)
								</para>
							</entry>
							<entry>
								<para>64-bit control</para>
							</entry>
							<entry>
								<para>64-bit server</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit application</para>
								<para>
									(AutoConnect &#8800; 0)
								</para>
							</entry>
							<entry>
								<para>64-bit control</para>
							</entry>
							<entry>
								<para>
									32-bit server<superscript>
										<legacyBold>1</legacyBold>
									</superscript>
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									<token>DA</token>
								</para>
							</entry>
							<entry>
								<para>
									ProgId&#160;<codeInline>DoubleAgent.Control</codeInline> or&#160;<codeInline>DoubleAgent.Control.1.1</codeInline>
								</para>
								<para>
									or&#160;ClassId&#160;<codeInline>{1147E530-A208-11DE-ABF2-002421116FB2}</codeInline>
								</para>
							</entry>
							<entry>
								<para>64-bit application</para>
								<para>
									(AutoConnect = 0)
								</para>
							</entry>
							<entry>
								<para>64-bit control</para>
								<para>
									(<token>standalone</token>)
								</para>
							</entry>
							<entry>
								<para>N/A</para>
							</entry>
						</row>
					</table>
					<para/>
					<alert class="note">
						<superscript>
							<legacyBold>1</legacyBold>
						</superscript>This behaviour is new in <token>DA</token> version 1.2. You can still use the 64-bit server by setting
						<codeEntityReference>P:DoubleAgent.Control.Control.AutoConnect</codeEntityReference> to <literal>64</literal> but
						the <legacyItalic>default</legacyItalic> server is the 32-bit server. This change was made for compatibility with <token>MA</token>.
					</alert>
				</listItem>
			</list>
		</introduction>

		<relatedTopics>
		</relatedTopics>

	</developerHowToDocument>
</topic>
