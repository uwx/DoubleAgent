<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
	<title>Speech Input Events</title>
	<link rel="STYLESHEET" href="../css/dahelp.css">
</head>
<body>
	<table class="pagetable" cellspacing="0">
		<tr>
			<td class="runninghead">Double&nbsp;Agent&nbsp;API</td>
		</tr>
		<tr>
			<td class="pagehead">
				<h3>Speech Input Events</h3>
			</td>
		</tr>
		<tr>
			<td class="page">
				<p>In addition, to the <b>Command</b> event notification, Agent also notifies the input-active client when
					the server turns the Listening mode on or off, using the <b>ListenStart</b> and <b>ListenComplete</b>
					events (<b>IAgentNotifySinkEx::ListeningState</b>). However, if the user presses the Listening mode
					key and there is no matching speech recognition engine available for the topmost character of the input-active
					client, the server starts the Listening hotkey mode time-out, but does not generate a <b>ListenStart</b>
					event for the active client of the character. If, before the time-out completes, the user activates
					another character with speech recognition engine support, the server attempts to activate speech input
					and generates the <b>ListenStart</b> event.</p>
				<p>Similarly, if a client attempts to turn on the Listening mode using the <b>Listen</b> method and there
					is no matching speech recognition engine available, the call fails and the server does not generate
					a <b>ListenStart </b>event. In the Microsoft Agent control, the <b>Listen</b> method returns <b>False</b>,
					but the call does not raise an error.</p>
				<p>When the Listening key mode is on and the user switches to a character that uses a different speech recognition
					engine, the server switches to and activates that engine and triggers a <b>ListenComplete</b> and then
					a <b>ListenStart</b> event. If the activated character does not have an available speech recognition
					engine (because one is not installed or none match the activated character's language ID setting), the
					server will trigger the <b>ListenComplete</b> event for the previously activated character and passes
					back a value in the <b>Cause</b> parameter. However, the server does not generate <b>ListenStart</b>
					or <b>ListenComplete</b> events for the clients that do not have speech recognition support.</p>
				<p>If a client successfully calls the <b>Listen</b> method and a character without speech recognition engine
					support becomes input-active before the Listening mode time-out completes, and then the user switches
					back to the character of the original client, the server will generate a <b>ListenStart</b> event for
					that client.</p>
				<p>If the input-active client switches speech recognition engines by changing <b>SRModeID</b> while in Listening
					mode, the server switches to and activates that engine without re-triggering the <b>ListenStart</b>
					event. However, if the specified engine is not available, the call fails (raises an error in the control)
					and the server also calls the <b>ListenComplete</b> event.</p>
			</td>
		</tr>
	</table>
</body>
</html>
