<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252">
	<title>Creating a Notification Sink</title>
	<link rel="STYLESHEET" href="../css/dahelp.css">
</head>
<body>
	<table class="pagetable" cellspacing="0" cellpadding="0">
		<tr>
			<td class="runninghead">Double&nbsp;Agent&nbsp;API</td>
		</tr>
		<tr>
			<td class="pagehead">
				<h3>Creating a Notification Sink</h3>
			</td>
		</tr>
		<tr>
			<td class="page">
				<p>To be notified of events by Microsoft Agent, you must implement either the <b>IAgentNotifySink </b>or
					the <b>IAgentNotifySinkEx</b> interface, and create and register an object of that type following COM
					conventions:</p>
				<pre>// Create a notification sink

pSinkEx = new AgentNotifySinkEx;

pSinkEx-&gt;AddRef();

// And register it with Microsoft Agent

hRes = pAgentEx-&gt;Register((IUnknown *)pSinkEx, &amp;lNotifySinkID);</pre>
				<p>Remember to unregister your notification sink when your application shuts down and releases Microsoft
					Agent's interfaces.</p>
				<p>---todo---</p>
				<p>IConnectionPoint</p>
				<p>WithEvents</p>
			</td>
		</tr>
	</table>
</body>
</html>
