<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The Style Property</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h4>The Style Property</h4>
				</td>
			</tr>
			<tr>
				<td class="page">
					<h4>Description</h4>
					<div class="summary">
				Returns or sets the character's word balloon output style.
			</div>
					<h4>Syntax</h4>
					<div class="syntax">
						<dl>
							<dt>Visual Basic .NET</dt>
							<dd>
<em>control</em><s>.Characters ("</s><em>CharacterID</em><s>").Balloon.Style</s>[ = <em>Integer</em>]
</dd>
							<dt>Visual Basic 6</dt>
							<dd>
<em>control</em><s>.Characters ("</s><em>CharacterID</em><s>").Balloon.Style</s>[ = <em>Integer</em>]
</dd>
							<dt>VBScript</dt>
							<dd>
<em>control</em><s>.Characters ("</s><em>CharacterID</em><s>").Balloon.Style</s>[ = <em>Integer</em>]
</dd>
							<dt>Visual C#</dt>
							<dd>
<em>control</em><s>.Characters ("</s><em>CharacterID</em><s>").Balloon.Style</s>[ = <em>int</em>];
</dd>
							<dt>Visual C++</dt>
							<dd>
<p>
<em>balloon</em>-&gt;<s>get_Style</s> (<em>&amp;long</em>);
</p>
<p>
<em>balloon</em>-&gt;<s>put_Style</s> (<em>long</em>);
</p>
</dd>
						</dl>
					</div>
					<h4>Remarks</h4>
					<p>
					When the balloon-on style bit is set to 1, the word balloon appears when a <a href="Control_Character_Speak.htm">Speak</a> or <a href="Control_Character_Think.htm">Think</a>
					method is used, unless the user overrides this setting in the Double Agent property sheet. When set
					to 0, a balloon does not appear.
				</p>
					<p>
					When the size-to-text style bit is set to 1, the word balloon automatically sizes the height of the balloon
					to the current size of the text for the <a href="Control_Character_Speak.htm">Speak</a> or <a href="Control_Character_Think.htm">Think</a> statement. When set to 0, the balloon's
					height is based on the <a href="Control_Balloon_NumberOfLines.htm">NumberOfLines</a> property setting. If this style bit is set to 1 and you
					attempt to set the <a href="Control_Balloon_NumberOfLines.htm">NumberOfLines</a> property, Agent raises an error.
				</p>
					<p>
					When the auto-hide style bit is set to 1, the word balloon automatically hides when spoken output completes.
					When set to 0, the balloon remains displayed until the next <a href="Control_Character_Speak.htm">Speak</a> or <a href="Control_Character_Think.htm">Think</a> call, the character
					is hidden, or the user clicks or drags the character.
				</p>
					<p>
					When the auto-pace style bit is set to 1, the word balloon paces the output based on the current output
					rate, for example, one word at a time. When output exceeds the size of the balloon, the former text
					is automatically scrolled. When set to 0, all text included in a <a href="Control_Character_Speak.htm">Speak</a> or <a href="Control_Character_Think.htm">Think</a> statement
					is displayed at once.
				</p>
					<p>
					To retrieve just the value of the bottom four bits, <s>And</s> the value returned by <s>Style</s> with
					255. To set a bit value, <s>Or</s> the value returned with the value of the bits you want set. To turn
					a bit off, <s>And</s> the value returned with one's complement of the bit:
				</p>
					<pre class="example">   Const BalloonOn = 1

   ' Turn the word balloon off
   Genie.Balloon.Style = Genie.Balloon.Style And (Not BalloonOn)
   Genie.Speak "No balloon"

   ' Turn the word balloon on
   Genie.Balloon.Style = Genie.Balloon.Style Or BalloonOn
   Genie.Speak "Balloon"</pre>
					<p>
					The <s>Style</s> property also returns the number of characters per line in the lower byte of the upper
					word and the number of lines in the high byte of the upper word. While this can be more easily read
					using the <s>CharsPerLine</s> and <s>NumberOfLines</s> properties, the <s>Style</s> property also enables
					you to set those values.
				</p>
					<p>
					For example, to change the number of lines, clear bits 24 to 31 with a logical <s>AND</s> operation before
					setting the new value as the product of the new value times 2^24, added to the existing value of the
					<s>Style</s> property.
				</p>
					<pre class="example">   ' Set the number of lines to 4
   Genie.Balloon.Style = (Genie.Balloon.Style <s>AND</s> &amp;H00FFFFFF) + (4*(2^24))</pre>
					<p>
					To set the number of characters per line, clear bits 16 to 23 with a logical <s>AND</s> operation before
					setting the new value as the product of the new value times 2^16, added to the existing value of the
					Style property.
				</p>
					<pre class="example">   ' Set the number of characters per line to 16
   Genie.Balloon.Style = (Genie.Balloon.Style AND &amp;HFF00FFFF) + (16*(2^16))</pre>
					<p>
					The <s>Style</s> property can be set even if the user has disabled balloon display using the Double
					Agent property sheet. However, the values for the number of lines must be between 1 and 128 and the
					number characters per line must be between 8 and 255. If you provide an invalid value for the <s>Style</s>
					property, Agent will raise an error.
				</p>
					<p>
					This property applies only to your client application's use of the character; the setting does not affect
					other clients of the character or other characters of your client application.
				</p>
					<p>
					The defaults for these style bits are based on their settings when the character is compiled with the
					Microsoft Agent Character Editor.
				</p>
				</td>
			</tr>
		</table>
	</body>
</html>