<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The RequestStart Event</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h4>The RequestStart Event</h4>
				</td>
			</tr>
			<tr>
				<td class="page">
					<h4>Description</h4>
					<div class="summary">
						<p>Signalled when Double Agent begins a queued request.</p>
					</div>
					<h4>Syntax</h4>
					<div class="syntax">
						<dl>
							<dt>Visual Basic .NET</dt>
							<dd>
<p><s>Event</s> <em>control</em>_<s>RequestStart</s> (<s>ByVal</s> <em>Request</em> <s>As <a href="Control_Request.htm">DoubleAgent.Control.Request</a></s>)</p>
</dd>
							<dt>Visual Basic 6</dt>
							<dd>
<p><s>Sub</s> <em>control</em>_<s>RequestStart</s> (<s>ByVal</s> <em>Request</em> <s>As <a href="Control_Request.htm">DaCtlRequest</a></s>)</p>
</dd>
							<dt>VBScript</dt>
							<dd>
<p><s>Sub</s> <em>control</em>_<s>RequestStart</s> (<s>ByVal</s> <em>Request</em>)</p>
</dd>
							<dt>Visual C#</dt>
							<dd>
<p><s>delegate void</s> <em>control</em>_<s>RequestStart<em>EventHandler</em></s><s> (<a href="Control_Request.htm">DoubleAgent.Control.Request</a></s> <em>Request</em>)</p>
</dd>
							<dt>Visual C++</dt>
							<dd>
<p><s>void</s> <em>control</em>_<s>RequestStart</s> (<s><a href="Control_Request.htm">IDaCtlRequest</a> *</s> <em>Request</em>)</p>
</dd>
						</dl>
						<table class="syntax">
							<tr>
								<th align="left" width="200ex">Part</th>
								<th align="left">Description</th>
							</tr>
							<tr>
								<td width="200ex">
									<i>Request</i>
								</td>
								<td>
				The <a href="Control_Request.htm">Request</a> object that identifies the queued request.
			</td>
							</tr>
						</table>
					</div>
					<h4>Remarks</h4>
					<p>
					The event provides a <a href="Control_Request.htm">Request</a> object. Because requests are processed asynchronously, you can use this event to determine when Double Agent begins processing a request (such as a <a href="Control_Character_Get.htm">Get</a>, <a href="Control_Character_Play.htm">Play</a>, or <a href="Control_Character_Speak.htm">Speak</a> method) and thereby synchronize this with other actions generated by your application. The event is sent only to the client that created the reference to the <a href="Control_Request.htm">Request</a> object, and only if you defined a global variable for the request reference.
				</p>
					<div class="example">
						<pre class="example">Dim MyRequest 
Dim Genie 

Sub window_Onload
    AgentControl.Characters.Load "Genie", "Genie.acs"

    Set Genie = AgentControl.Characters("Genie")

    ' This syntax will generate RequestStart and RequestComplete events.
    Set MyRequest = Genie.Show(False)

    ' This syntax will not generate RequestStart and RequestComplete events.
    Genie.Hide False
End Sub

Sub AgentControl_RequestStart(ByVal Request)
    If Request Is MyRequest Then
        Status = "Genie is showing"
End Sub</pre>
					</div>
					<p>
					The <a href="Control_Request_Status.htm">Request.Status</a> property is 4 (request in progress) for the <a href="Control_Request.htm">Request</a> object.
				</p>
					<p>
					Because animation <a href="Control_Request.htm">Request</a> objects don't get assigned until Double Agent has queued the request, make sure that the <a href="Control_Request.htm">Request</a> object exists before you attempt to evaluate it. For example, in Visual Basic, if you use a conditional to test whether a specific request was completed, you can use the <s>Nothing</s> keyword.
				</p>
					<div class="example">
						<pre class="example">Sub AgentControl_RequestStart (ByVal Request)
    If Not (MyRequest Is Nothing) Then
        If Request Is MyRequest Then
            '-- Do whatever
        End If
    End If
End Sub</pre>
					</div>
					<br />
					<h4>See Also</h4>
					<a href="Control_Event_RequestComplete.htm">RequestComplete Event</a>
				</td>
			</tr>
		</table>
	</body>
</html>