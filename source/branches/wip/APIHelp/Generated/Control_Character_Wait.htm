<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<HTML>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The Wait Method</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0" cellpadding="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h4>The Wait Method</h4>
				</td>
			</tr>
			<tr>
				<td class="page">
					<h4 class="summary">Description</h4>
					<div class="summary">
						<p>
					Causes the animation queue for the specified character to wait until the specified animation
					request completes.
				</p>
					</div>
					<h4 class="syntax">Syntax</h4>
					<div class="syntax">
						<dl>
							<dt>Visual Basic .NET</dt>
							<dd>
<p>[<em>Request</em> = ]<em>control</em>.<s>Characters</s> ("<em>CharacterID</em>").<s>Wait</s> (<em>WaitRequest</em>)</p>
</dd>
							<dt>Visual Basic 6</dt>
							<dd>
<p>[<s>Set</s> <em>Request</em> = ]<em>control</em>.<s>Characters</s> ("<em>CharacterID</em>").<s>Wait</s> <em>WaitRequest</em></p>
</dd>
							<dt>VBScript</dt>
							<dd>
<p>[<s>Set</s> <em>Request</em> = ]<em>control</em>.<s>Characters</s> ("<em>CharacterID</em>").<s>Wait</s> <em>WaitRequest</em></p>
</dd>
							<dt>Visual C#</dt>
							<dd>
<p>[<em>Request</em> = ]<em>control</em>.<s>Characters</s>.this ["<em>CharacterID</em>"].<s>Wait</s> (<em>WaitRequest</em>)</p>
</dd>
							<dt>Visual C++</dt>
							<dd>
<p><em>character</em>.<s>Wait</s> (<em>WaitRequest</em>, &amp;<em>Request</em>)</p>
</dd>
						</dl>
						<table class="syntax">
							<tr>
								<th align="left" width="200ex">Part</th>
								<th align="left">Description</th>
							</tr>
							<tr>
								<td width="200ex">
									<i>WaitRequest</i>
								</td>
								<td>
				A <s><a href="Control_Request.htm" class="see">Request</a></s> object specifying the animation to wait for.
			</td>
							</tr>
							<tr>
								<td width="200ex">
									<i>Request</i>
								</td>
								<td>
				A <s><a href="Control_Request.htm" class="see">Request</a></s> object your application can used to track the method's status.
			</td>
							</tr>
						</table>
					</div>
					<h4 class="remarks">Remarks</h4>
					<p>
					Use this method only when you are using multiple (simultaneous) characters and are trying to
					sequence the interaction of characters. (For a single character, each animation request is played sequentially--after
					the previous request completes.)
				</p>
					<p>
					If you have two characters and you want one character's animation request to wait until the
					other character's animation completes, use the <s>Wait </s>method with the other character's animation
					<a href="Control_Request.htm" class="see">Request</a> object.
				</p>
					<div class="example">
						<p>
						To specify the request parameter, create a variable for animation request you want to wait
						for:
					</p>
						<pre class="example">Dim GenieRequest
Dim RobbyRequest
Dim Genie
Dim Robby

Sub window_Onload
    AgentControl.Characters.Load "Genie", "Genie.acs"
    AgentControl.Characters.Load "Robby", "Robby.acs"

    Set Genie = AgentControl.Characters("Genie")
    Set Robby = AgentControl.Characters("Robby")

    Genie.MoveTo 100,100
    Genie.Show

    Robby.MoveTo 250,100
    Robby.Show

    Genie.Play "Announce"
    Set GenieRequest = Genie.Speak ("Why did the chicken cross the road?")

    Robby.Wait GenieRequest
    Robby.Play "Confused"
    Set RobbyRequest = Robby.Speak ("I don't know. Why did the chicken cross the road?")

    Genie.Wait RobbyRequest
    Genie.Play "Pleased"
    Set GenieRequest = Genie.Speak ("To get to the other side.")

    Robby.Wait GenieRequest
    Robby.Play "Sad"
    Robby.Speak "I never should have asked."
End Sub</pre>
					</div>
					<div class="example">
						<p>
						You can also streamline your code by just calling <s>Wait </s>directly, using a specific
						animation request.
					</p>
						<pre class="example">
Robby.Wait Genie.Play "GestureRight"
</pre>
						<p>
						This avoids having to explicitly declare a <a href="Control_Request.htm" class="see">Request</a> object.
					</p>
					</div>
				</td>
			</tr>
		</table>
	</body>
</HTML>