<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<HTML>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The DragComplete Event</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0" cellpadding="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h3>The DragComplete Event</h3>
				</td>
			</tr>
			<tr>
				<td class="page">
					<h4 class="summary">Description</h4>
					<div class="summary">
				<p>Signalled when the user stops dragging a character.</p>
			</div>
					<h4 class="syntax">Syntax</h4>
					<div id="Syntax" class="syntax">
						<table id="Languages" class="syntax">
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual Basic .NET</p>
								</td>
								<td>
<p><em class="keyword">Event</em> <em class="token">control</em>_<em class="keyword">DragComplete</em> (<em class="keyword">ByVal</em> <em class="token">CharacterID</em> <em class="keyword">As String</em>, <em class="keyword">ByVal</em> <em class="token">Button</em> <em class="keyword">As Short</em>, <em class="keyword">ByVal</em> <em class="token">Shift</em> <em class="keyword">As Short</em>, <em class="keyword">ByVal</em> <em class="token">X</em> <em class="keyword">As Short</em>, <em class="keyword">ByVal</em> <em class="token">Y</em> <em class="keyword">As Short</em>)</p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual Basic 6</p>
								</td>
								<td>
<p><em class="keyword">Sub</em> <em class="token">control</em>_<em class="keyword">DragComplete</em> (<em class="keyword">ByVal</em> <em class="token">CharacterID</em> <em class="keyword">As String</em>, <em class="keyword">ByVal</em> <em class="token">Button</em> <em class="keyword">As Integer</em>, <em class="keyword">ByVal</em> <em class="token">Shift</em> <em class="keyword">As Integer</em>, <em class="keyword">ByVal</em> <em class="token">X</em> <em class="keyword">As Integer</em>, <em class="keyword">ByVal</em> <em class="token">Y</em> <em class="keyword">As Integer</em>)</p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>VBScript</p>
								</td>
								<td>
<p><em class="keyword">Sub</em> <em class="token">control</em>_<em class="keyword">DragComplete</em> (<em class="keyword">ByVal</em> <em class="token">CharacterID</em>, <em class="keyword">ByVal</em> <em class="token">Button</em>, <em class="keyword">ByVal</em> <em class="token">Shift</em>, <em class="keyword">ByVal</em> <em class="token">X</em>, <em class="keyword">ByVal</em> <em class="token">Y</em>)</p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual C#</p>
								</td>
								<td>
<p><em class="keyword">delegate void</em> <em class="token">control</em>_<em class="keyword">DragComplete<token>EventHandler</token></em> (<em class="keyword">string</em> <em class="token">CharacterID</em>, <em class="keyword">short</em> <em class="token">Button</em>, <em class="keyword">short</em> <em class="token">Shift</em>, <em class="keyword">short</em> <em class="token">X</em>, <em class="keyword">short</em> <em class="token">Y</em>)</p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual C++</p>
								</td>
								<td>
<p><em class="keyword">void</em> <em class="token">control</em>_<em class="keyword">DragComplete</em> (<em class="keyword">LPCTSTR</em> <em class="token">CharacterID</em>, <em class="keyword">short</em> <em class="token">Button</em>, <em class="keyword">short</em> <em class="token">Shift</em>, <em class="keyword">short</em> <em class="token">X</em>, <em class="keyword">short</em> <em class="token">Y</em>)</p>
</td>
							</tr>
						</table>
						<table id="Parameters" class="syntax">
							<tr>
								<th align="left" width="200ex">Part</th>
								<th align="left">Description</th>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">CharacterID</em>
								</td>
								<td>The unique identifier of the character that was dragged.</td>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">Button</em>
								</td>
								<td>
			A numeric value that identifies which button was pressed and released to cause the
			event. The button argument is a bit field with bits corresponding to the left button (bit 0), right
			button (bit 1), and middle button (bit 2). These bits correspond to the values 1, 2, and 4, respectively.
			Only one of the bits is set, indicating the button that caused the event. If the character includes
			a taskbar icon, and bit 13 is also set, the click occurred on the taskbar icon.
		</td>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">Shift</em>
								</td>
								<td>
			A numeric value that corresponds to the state of the <em class="filename">Shift</em>, <em class="filename">Ctrl</em>, and <em class="filename">Alt</em> keys when the
			button was pressed or released. A bit is set if the key is down. The
			shift argument is a bit field with the least-significant bits corresponding to the <em class="filename">Shift</em> key (bit 0),
			the <em class="filename">Ctrl</em> key (bit 1), and the <em class="filename">Alt</em> key (bit 2). These bits correspond to the values 1, 2, and 4, respectively.
			Some, all, or none of the bits can be set, indicating
			that some, all, or none of the keys are pressed. For example, if both <em class="filename">Ctrl</em> and <em class="filename">Alt</em> were pressed, the
			value of <em class="filename">Shift</em> would be 6.
		</td>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">X</em>
								</td>
								<td>
			The current horizontal location of the mouse pointer, in pixels, relative to the left side of the screen.
		</td>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">Y</em>
								</td>
								<td>
			The current vertical location of the mouse pointer, in pixels, relative to the top of the screen.
		</td>
							</tr>
						</table>
					</div>
					<h4 class="remarks">Remarks</h4>
				<p>
					This event is sent only to the <em class="glossary">input-active</em> client of a character. When the user
					drags a character with no <em class="glossary">input-active</em> client, Double Agent sets its current <em class="glossary">input-active</em>
					client as the last <em class="glossary">input-active</em> client, sending the <a href="Control_Event_ActivateInput.htm" class="see keyword">ActivateInput</a>
					event to that client, and then sending the <a href="Control_Event_DragStart.htm" class="see keyword">DragStart</a> and <em class="keyword">DragComplete</em>
					events.
				</p>
			<h4 class="seealso">See Also</h4><a href="Control_Event_DragStart.htm">The DragStart Event</a></td>
			</tr>
		</table>
	</body>
</HTML>