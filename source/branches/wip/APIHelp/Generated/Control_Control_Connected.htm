<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<HTML>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The Connected Property</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0" cellpadding="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h3>The Connected Property</h3>
				</td>
			</tr>
			<tr>
				<td class="page">
					<h4 class="summary">Description</h4>
					<div class="summary">
				<p>Specifies if the control is currently connected to the Double Agent server.</p>
				<p>
					The Double Agent control will work whether or not it's connected to the server, but there are are special
					considerations in each case. See <a href="..\Programming\Ctl_Programming_Modes.htm">Connected, Stand-Alone, and Contained</a>
					for more information.
				</p>
			</div>
					<h4 class="syntax">Syntax</h4>
					<div id="Syntax" class="syntax">
						<table id="Languages" class="syntax">
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual Basic .NET</p>
								</td>
								<td>
<p>[<em class="token">Connected</em> = ]<em class="token">control</em>.<em class="keyword">Connected</em></p>
<p><em class="token">control</em>.<em class="keyword">Connected</em> = <em class="token">Connected</em></p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual Basic 6</p>
								</td>
								<td>
<p>[<em class="token">Connected</em> = ]<em class="token">control</em>.<em class="keyword">Connected</em></p>
<p><em class="token">control</em>.<em class="keyword">Connected</em> = <em class="token">Connected</em></p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>VBScript</p>
								</td>
								<td>
<p>[<em class="token">Connected</em> = ]<em class="token">control</em>.<em class="keyword">Connected</em></p>
<p><em class="token">control</em>.<em class="keyword">Connected</em> = <em class="token">Connected</em></p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual C#</p>
								</td>
								<td>
<p>[<em class="token">Connected</em> = ]<em class="token">control</em>.<em class="keyword">Connected</em></p>
<p><em class="token">control</em>.<em class="keyword">Connected</em> = <em class="token">Connected</em></p>
</td>
							</tr>
							<tr>
								<td align="left" width="200ex" class="language">
									<p>Visual C++</p>
								</td>
								<td>
<p><em class="token">control</em>-&gt;<em class="keyword">get_Connected</em> (&amp;<em class="token">Connected</em>)</p>
<p><em class="token">control</em>-&gt;<em class="keyword">put_Connected</em> (<em class="token">Connected</em>)</p>
</td>
							</tr>
						</table>
						<table id="Parameters" class="syntax">
							<tr>
								<th align="left" width="200ex">Part</th>
								<th align="left">Description</th>
							</tr>
							<tr>
								<td width="200ex">
									<em class="token">Connected</em>
								</td>
								<td>
				A <em class="typename">boolean</em> value specifying whether the control is connected.
			</td>
							</tr>
						</table>
					</div>
					<h4 class="remarks">Remarks</h4>
				<p>
					You can manually open or close the connection to the server by changing the <em class="self keyword">Connected</em>
					property. When the connection state changes, any characters you've loaded are automatically unloaded. If
					you still have references to any objects except the control itself, any attempt to access the objects'
					properties or methods will fail.
				</p>
			
				<h4 class="details">Details</h4>
				<p>
					In many situations, using the control automatically creates a connection with the Double Agent server
					(depending on the <a href="Control_Control_AutoConnect.htm" class="see keyword">AutoConnect</a> property setting). For example, using the Double
					Agent control's CLSID in the &lt;OBJECT&gt; tag in a Web page automatically opens a server connection and
					exiting the page closes the connection. Similarly, for Visual Basic or other languages that enable
					you to drop a control on a form, running the program automatically opens a connection and exiting
					the program closes the connection. If the server isn't currently running, it automatically starts.
				</p>
				<p>
					When you release <s>all</s> references to Double Agent objects, such as <a href="Control_Character.htm" class="see keyword">Character</a>
					and <a href="Control_Command.htm" class="see keyword">Command</a>, the connection with the Double Agent server will automatically be
					closed. You must also release your reference to the <a href="Control_Control.htm" class="see keyword">Control Object</a> itself. In
					Visual Basic, you can release a reference to an object by setting its variable to <em class="keyword">Nothing</em>.
					If you have loaded characters, your should unload them before releasing the <a href="Control_Character.htm" class="see keyword">Character Object</a>.
				</p>
				<h4 class="details">Example</h4>
				<pre class="example"><em class="keyword">Dim</em> <em class="keyword">WithEvents</em> MyAgent <em class="keyword">as</em> <em class="keyword">DoubleAgentCtl</em>
<em class="keyword">Dim</em> Genie <em class="keyword">as</em> <em class="keyword">DaCtlCharacter</em>

<em class="keyword">Sub</em> Form_Load
    ' Create an instance of the control using New
    <em class="keyword">Set</em> MyAgent = <em class="keyword">New</em> <em class="keyword">DoubleAgentCtl</em>

    ' Open a connection to the server
    MyAgent.<em class="keyword">Connected</em> = <em class="keyword">True</em>

    ' Load the character into the Characters collection
    MyAgent.<em class="keyword">Characters</em>.<em class="keyword">Load</em> "Genie", "Genie.acs"

    ' Create a reference to the character
    <em class="keyword">Set</em> Genie = MyAgent.<em class="keyword">Characters</em> ("Genie")
<em class="keyword">End Sub</em>

<em class="keyword">Sub</em> CloseConnection
    ' Unload the character
    MyAgent.<em class="keyword">Charcters</em>.<em class="keyword">Unload</em> "Genie"

    ' Release the reference to the character object
    <em class="keyword">Set</em> Genie = <em class="keyword">Nothing</em>

    ' Release the reference to the Agent control
    <em class="keyword">Set</em> MyAgent = <em class="keyword">Nothing</em>
<em class="keyword">End Sub</em></pre>
			<h4 class="seealso">See Also</h4><a href="Control_Control_AutoConnect.htm">The AutoConnect Property</a></td>
			</tr>
		</table>
	</body>
</HTML>