<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The Character Object</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h3>The Character Object</h3>
				</td>
			</tr>
			<tr>
				<td class="page">
					<p>
					The <s>Character</s> object provides the methods and properties your application will use to access the bulk of Double Agent's features.
				</p>
					<ul>
						<li>
							The <s>Character</s> object has the following <s>methods</s>:
						<p><a href="Control_Character_Activate.htm">Activate</a>,
							<a href="Control_Character_FindSREngines.htm">FindSREngines</a>,
							<a href="Control_Character_FindTTSEngines.htm">FindTTSEngines</a>,
							<a href="Control_Character_GenerateIcon.htm">GenerateIcon</a>,
							<a href="Control_Character_GestureAt.htm">GestureAt</a>,
							<a href="Control_Character_Prepare.htm">Prepare</a>,
							<a href="Control_Character_Hide.htm">Hide</a>,
							<a href="Control_Character_Interrupt.htm">Interrupt</a>,
							<a href="Control_Character_Listen.htm">Listen</a>,
							<a href="Control_Character_MoveTo.htm">MoveTo</a>,
							<a href="Control_Character_Play.htm">Play</a>,
							<a href="Control_Character_Show.htm">Show</a>,
							<a href="Control_Character_ShowPopupMenu.htm">ShowPopupMenu</a>,
							<a href="Control_Character_Speak.htm">Speak</a>,
							<a href="Control_Character_Stop.htm">Stop</a>,
							<a href="Control_Character_StopAll.htm">StopAll</a>,
							<a href="Control_Character_Think.htm">Think</a>,
							<a href="Control_Character_Wait.htm">Wait</a></p></li>
						<li>
							The <s>Character</s> object has the following <s>properties</s>:
						<p><a href="Control_Character_Active.htm">Active</a>,
							<a href="Control_Character_AutoPopupMenu.htm">AutoPopupMenu</a>,
							<a href="Control_Character_Description.htm">Description</a>,
							<a href="Control_Character_ExtraData.htm">ExtraData</a>,
							<a href="Control_Character_GUID.htm">GUID</a>,
							<a href="Control_Character_HasOtherClients.htm">HasOtherClients</a>,
							<a href="Control_Character_Height.htm">Height</a>,
							<a href="Control_Character_HelpContextID.htm">HelpContextID</a>,
							<a href="Control_Character_HelpFile.htm">HelpFile</a>,
							<a href="Control_Character_HelpModeOn.htm">HelpModeOn</a>,
							<a href="Control_Character_IdleOn.htm">IdleOn</a>,
							<a href="Control_Character_LanguageID.htm">LanguageID</a>,
							<a href="Control_Character_Left.htm">Left</a>,
							<a href="Control_Character_MoveCause.htm">MoveCause</a>,
							<a href="Control_Character_Name.htm">Name</a>,
							<a href="Control_Character_OriginalHeight.htm">OriginalHeight</a>,
							<a href="Control_Character_OriginalWidth.htm">OriginalWidth</a>,
							<a href="Control_Character_Pitch.htm">Pitch</a>,
							<a href="Control_Character_SoundEffectsOn.htm">SoundEffectsOn</a>,
							<a href="Control_Character_Speed.htm">Speed</a>,
							<a href="Control_Character_SRModeID.htm">SRModeID</a>,
							<a href="Control_Character_SRStatus.htm">SRStatus</a>,
							<a href="Control_Character_Top.htm">Top</a>,
							<a href="Control_Character_TTSModeID.htm">TTSModeID</a>,
							<a href="Control_Character_Version.htm">Version</a>,
							<a href="Control_Character_VisibilityCause.htm">VisibilityCause</a>,
							<a href="Control_Character_Visible.htm">Visible</a>,
							<a href="Control_Character_Width.htm">Width</a></p></li>
					</ul>
					<h4>Remarks</h4>
					<p>
					Because the server loads an HTTP character asynchronously, ensure that the character has been loaded before
					querying its properties, for example, using the <a href="Control_Event_RequestComplete.htm">RequestComplete</a> event. Otherwise, the properties
					may return incorrect values.
				</p>
					<p>
						<b>Note:</b>&nbsp;
					The <a href="Control_Character_Height.htm">Height</a>, <a href="Control_Character_Left.htm">Left</a>, <a href="Control_Character_Top.htm">Top</a>, and <a href="Control_Character_Width.htm">Width</a> properties refer
					to the position and size of the <s>Character</s>, not the location of the Double Agent control.
				</p>
					<br />
					<h4>Referencing the Character Object</h4>
					<div class="example">
						<p>
						To use a method or property, reference the character in the <a href="Control_Characters.htm">Characters</a> collection. In VBScript and Visual Basic, you do this
						by specifying the unique identifier you assigned when you loaded the character:
					</p>
						<pre class="example">Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Display the character
    AgentControl.Characters("Genie").Show
    AgentControl.Characters("Genie").Play "Greet"
    AgentControl.Characters("Genie").Speak "Hello."
End Sub</pre>
					</div>
					<div class="example">
						<p>
						To simplify the syntax of your code, you can define an object variable and set it to reference a character
						object in the <a href="Control_Characters.htm">Characters</a> collection.  Then you can use your variable to reference methods or properties
						of the character. The following example demonstrates how you can do this using the Visual Basic <s>Set</s>
						statement:
					</p>
						<pre class="example">'Define a global object variable
Dim Genie as Object

Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Create a reference to the character
    Set Genie = AgentControl.Characters("Genie")

    'Display the character
    Genie.Show

    'Make the character say Hello
    Genie.Speak "Hello."
End Sub</pre>
					</div>
					<div class="example">
						<p>
						In Visual Basic, you can also create your reference by declaring your variable as a <a href="Control_Character.htm">Character</a> object:
					</p>
						<pre class="example">Dim Genie as DaCtlCharacter

Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Create a reference to the character
    Set Genie = AgentControl.Characters("Genie")

    'Display the character
    Genie.Show
End Sub</pre>
						<p>
						Declaring an object of type <s>DaCtlCharacter</s> enables early binding on the object, which allows immediate syntax checking and
						results in better performance.
					</p>
					</div>
					<div class="example">
						<p>
						In VBScript, you cannot declare a reference as a particular type. However, you can simply declare the
						variable reference:
					</p>
						<pre class="example">&lt;SCRIPT LANGUAGE = "VBScript"&gt;
&lt;!--
Dim Genie

Sub window_OnLoad
    'Load the character
    AgentCtl.Characters.Load "Genie", "http://agent.microsoft.com/characters/v2/genie/genie.acf"

    'Create an object reference to the character in the collection
    set Genie= AgentCtl.Characters ("Genie")

    'Prepare the Showing state animation
    Genie.Prepare "state", "Showing"

    'Display the character
    Genie.Show
End Sub
--&gt;
&lt;/SCRIPT&gt;</pre>
					</div>
					<div class="example">
						<p>
						Some programming languages do not support collections. However, you can access a <a href="Control_Character.htm">Character</a> object's
						methods with the <a href="Control_Characters_Character.htm">Character</a> method:
					</p>
						<pre class="example">
<em>control</em>.Characters.Character("<em>CharacterID</em>").<em>method</em></pre>
					</div>
					<div class="example">
						<p>
						In addition, you can create a reference to the <s>Character</s> object to make your script code
						easier to follow:
					</p>
						<pre class="example">&lt;SCRIPT LANGUAGE="JScript" FOR="window" EVENT="onLoad()"&gt;
&lt;!--
//Load the character's data
AgentControl.Characters.Load ("Genie", "http://agent.microsoft.com/characters/v2/genie/genie.acf");

//Create a reference to this object
Genie = AgentControl.Characters.Character("Genie");

//Prepare the Showing state animation
Genie.Prepare("state", "Showing");

//Display the character
Genie.Show();
--&gt;
&lt;/SCRIPT&gt;</pre>
					</div>
				</td>
			</tr>
		</table>
	</body>
</html>