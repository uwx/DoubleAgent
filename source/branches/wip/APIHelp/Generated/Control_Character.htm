<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" ""[]>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
		<title>The Character Object</title>
		<link rel="STYLESHEET" href="../css/dahelp.css" />
	</head>
	<body>
		<table class="pagetable" cellspacing="0">
			<tr>
				<td class="runninghead">Double Agent API</td>
			</tr>
			<tr>
				<td class="pagehead">
					<h3>The Character Object</h3>
				</td>
			</tr>
			<tr>
				<td class="page">
					<p>
					The <s>Character</s> object provides the methods and properties your application will use to access the bulk of Double Agent's features.
				</p>
					<ul>
						<li>
							<a name="Methods"> </a>
							The <s>Character</s> object has the following <s>methods</s>:
						<p><a href="Control_Character_Activate.htm" class="see">Activate</a>,
							<a href="Control_Character_FindSREngines.htm" class="see">FindSREngines</a>,
							<a href="Control_Character_FindTTSEngines.htm" class="see">FindTTSEngines</a>,
							<a href="Control_Character_GenerateIcon.htm" class="see">GenerateIcon</a>,
							<a href="Control_Character_GestureAt.htm" class="see">GestureAt</a>,
							<a href="Control_Character_Prepare.htm" class="see">Prepare</a>,
							<a href="Control_Character_Hide.htm" class="see">Hide</a>,
							<a href="Control_Character_Interrupt.htm" class="see">Interrupt</a>,
							<a href="Control_Character_Listen.htm" class="see">Listen</a>,
							<a href="Control_Character_MoveTo.htm" class="see">MoveTo</a>,
							<a href="Control_Character_Play.htm" class="see">Play</a>,
							<a href="Control_Character_Show.htm" class="see">Show</a>,
							<a href="Control_Character_ShowPopupMenu.htm" class="see">ShowPopupMenu</a>,
							<a href="Control_Character_Speak.htm" class="see">Speak</a>,
							<a href="Control_Character_Stop.htm" class="see">Stop</a>,
							<a href="Control_Character_StopAll.htm" class="see">StopAll</a>,
							<a href="Control_Character_Think.htm" class="see">Think</a>,
							<a href="Control_Character_Wait.htm" class="see">Wait</a></p></li>
						<li>
							<a name="Properties"> </a>
							The <s>Character</s> object has the following <s>properties</s>:
						<p><a href="Control_Character_Active.htm" class="see">Active</a>,
							<a href="Control_Character_ActiveState.htm" class="see">ActiveState</a>,
							<a href="Control_Character_AnimationNames.htm" class="see">AnimationNames</a>,
							<a href="Control_Character_AutoPopupMenu.htm" class="see">AutoPopupMenu</a>,
							<a href="Control_Character_Balloon.htm" class="see">Balloon</a>,
							<a href="Control_Character_CharacterID.htm" class="see">CharacterID</a>,
							<a href="Control_Character_Commands.htm" class="see">Commands</a>,
							<a href="Control_Character_Connected.htm" class="see">Connected</a>,
							<a href="Control_Character_Description.htm" class="see">Description</a>,
							<a href="Control_Character_ExtraData.htm" class="see">ExtraData</a>,
							<a href="Control_Character_FileName.htm" class="see">FileName</a>,
							<a href="Control_Character_FilePath.htm" class="see">FilePath</a>,
							<a href="Control_Character_HasIcon.htm" class="see">HasIcon</a>,
							<a href="Control_Character_HasOtherClients.htm" class="see">HasOtherClients</a>,
							<a href="Control_Character_Height.htm" class="see">Height</a>,
							<a href="Control_Character_IconIdentity.htm" class="see">IconIdentity</a>,
							<a href="Control_Character_IconShown.htm" class="see">IconShown</a>,
							<a href="Control_Character_IconTip.htm" class="see">IconTip</a>,
							<a href="Control_Character_IconVisible.htm" class="see">IconVisible</a>,
							<a href="Control_Character_IdleEnabled.htm" class="see">IdleEnabled</a>,
							<a href="Control_Character_IdleState.htm" class="see">IdleState</a>,
							<a href="Control_Character_LanguageID.htm" class="see">LanguageID</a>,
							<a href="Control_Character_Left.htm" class="see">Left</a>,
							<a href="Control_Character_ListeningStatus.htm" class="see">ListeningStatus</a>,
							<a href="Control_Character_MoveCause.htm" class="see">MoveCause</a>,
							<a href="Control_Character_Name.htm" class="see">Name</a>,
							<a href="Control_Character_OriginalHeight.htm" class="see">OriginalHeight</a>,
							<a href="Control_Character_OriginalWidth.htm" class="see">OriginalWidth</a>,
							<a href="Control_Character_Pitch.htm" class="see">Pitch</a>,
							<a href="Control_Character_Smoothed.htm" class="see">Smoothed</a>,
							<a href="Control_Character_SmoothEdges.htm" class="see">SmoothEdges</a>,
							<a href="Control_Character_SoundEffectsEnabled.htm" class="see">SoundEffectsEnabled</a>,
							<a href="Control_Character_Speed.htm" class="see">Speed</a>,
							<a href="Control_Character_SREngine.htm" class="see">SREngine</a>,
							<a href="Control_Character_SRModeID.htm" class="see">SRModeID</a>,
							<a href="Control_Character_Style.htm" class="see">Style</a>,
							<a href="Control_Character_Top.htm" class="see">Top</a>,
							<a href="Control_Character_TTSEngine.htm" class="see">TTSEngine</a>,
							<a href="Control_Character_TTSModeID.htm" class="see">TTSModeID</a>,
							<a href="Control_Character_UniqueID.htm" class="see">UniqueID</a>,
							<a href="Control_Character_Version.htm" class="see">Version</a>,
							<a href="Control_Character_VisibilityCause.htm" class="see">VisibilityCause</a>,
							<a href="Control_Character_Visible.htm" class="see">Visible</a>,
							<a href="Control_Character_Width.htm" class="see">Width</a></p><p class="note"><span class="note">Note:</span> 
								The <a href="Control_Character_Height.htm" class="see">Height</a>, <a href="Control_Character_Left.htm" class="see">Left</a>, <a href="Control_Character_Top.htm" class="see">Top</a>, and <a href="Control_Character_Width.htm" class="see">Width</a> properties refer
								to the position and size of the <s>Character</s>, not the location of the Double Agent control.
							</p></li>
					</ul>
					<h4 class="remarks">Remarks</h4>
					<p>
					Because the server loads an HTTP character asynchronously, ensure that the character has been loaded before
					querying its properties, for example, using the <a href="Control_Event_RequestComplete.htm" class="see">RequestComplete</a> event. Otherwise, the properties
					may return incorrect values.
				</p>
					<h4 class="remarks">Referencing the Character Object</h4>
					<ul>
						<li>
							To use a method or property, reference the character in the <a href="Control_Characters.htm" class="see">Characters</a> collection. In VBScript and Visual Basic, you do this
							by specifying the unique identifier you assigned when you loaded the character:
						<pre class="example">Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Display the character
    AgentControl.Characters("Genie").Show
    AgentControl.Characters("Genie").Play "Greet"
    AgentControl.Characters("Genie").Speak "Hello."
End Sub</pre></li>
						<li>
							To simplify the syntax of your code, you can define an object variable and set it to reference a character
							object in the <a href="Control_Characters.htm" class="see">Characters</a> collection.  Then you can use your variable to reference methods or properties
							of the character. The following example demonstrates how you can do this using the Visual Basic <s>Set</s>
							statement:
						<pre class="example">'Define a global object variable
Dim Genie as Object

Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Create a reference to the character
    Set Genie = AgentControl.Characters("Genie")

    'Display the character
    Genie.Show

    'Make the character say Hello
    Genie.Speak "Hello."
End Sub</pre></li>
						<li>
							In Visual Basic, you can also create your reference by declaring your variable as a <a href="Control_Character.htm" class="see">Character</a> object:
						<pre class="example">Dim Genie as DaControl.DaCtlCharacter

Sub FormLoad
    'Load the genie character into the Characters collection
    AgentControl.Characters.Load "Genie", "Genie.acs"

    'Create a reference to the character
    Set Genie = AgentControl.Characters("Genie")

    'Display the character
    Genie.Show
End Sub</pre><p>
								Declaring an object of type <s>DaCtlCharacter</s> enables early binding on the object, which allows immediate syntax checking and results in better performance.
							</p></li>
						<li>
							In VBScript, you cannot declare a reference as a particular type. However, you can simply declare the
							variable reference:
						<pre class="example">&lt;SCRIPT LANGUAGE = "VBScript"&gt;
&lt;!--
Dim Genie

Sub window_OnLoad
    'Load the character
    AgentCtl.Characters.Load "Genie", "http://agent.microsoft.com/characters/v2/genie/genie.acf"

    'Create an object reference to the character in the collection
    set Genie= AgentCtl.Characters ("Genie")

    'Prepare the Showing state animation
    Genie.Prepare "state", "Showing"

    'Display the character
    Genie.Show
End Sub
--&gt;
&lt;/SCRIPT&gt;</pre></li>
						<li>
							Some programming languages do not support collections. However, you can access a <a href="Control_Character.htm" class="see">Character</a> object's
							methods with the <a href="Control_Characters_Character.htm" class="see">Character</a> method:
						<pre class="example">
<em>control</em>.Characters.Character("<em>CharacterID</em>").<em>method</em></pre></li>
						<li>
							In addition, you can create a reference to the <s>Character</s> object to make your script code
							easier to follow:
						<pre class="example">&lt;SCRIPT LANGUAGE="JScript" FOR="window" EVENT="onLoad()"&gt;
&lt;!--
//Load the character's data
AgentControl.Characters.Load ("Genie", "http://agent.microsoft.com/characters/v2/genie/genie.acf");

//Create a reference to this object
Genie = AgentControl.Characters.Character("Genie");

//Prepare the Showing state animation
Genie.Prepare("state", "Showing");

//Display the character
Genie.Show();
--&gt;
&lt;/SCRIPT&gt;</pre></li>
					</ul>
				</td>
			</tr>
		</table>
	</body>
</html>